#include "Painter.h"
#include "MagneticSimulator.h"
#include "MagneticAdviser.h"
#include "InputsWrapper.h"
#include "TestingUtils.h"
#include "Settings.h"

#include <UnitTest++.h>
#include <vector>

SUITE(MagneticSimulator) {

    auto settings = OpenMagnetics::Settings::GetInstance();
    auto outputFilePath = std::filesystem::path{ __FILE__ }.parent_path().append("..").append("output");
    TEST(MagneticSimulator) {
        srand (time(NULL));

        std::vector<double> turnsRatios;

        std::vector<int64_t> numberTurns = {24, 24, 48};
        std::vector<int64_t> numberParallels = {1, 1, 1};

        for (size_t windingIndex = 1; windingIndex < numberTurns.size(); ++windingIndex) {
            turnsRatios.push_back(double(numberTurns[0]) / numberTurns[windingIndex]);
        }

        double frequency = 57026;
        double magnetizingInductance = 10e-6;
        double temperature = 25;
        OpenMagnetics::WaveformLabel waveShape = OpenMagnetics::WaveformLabel::TRIANGULAR;
        double peakToPeak = 10;
        double dutyCycle = 0.5;
        double dcCurrent = 0;


        auto inputs = OpenMagnetics::InputsWrapper::create_quick_operating_point_only_current(frequency,
                                                                                              magnetizingInductance,
                                                                                              temperature,
                                                                                              waveShape,
                                                                                              peakToPeak,
                                                                                              dutyCycle,
                                                                                              dcCurrent,
                                                                                              turnsRatios);

        OpenMagnetics::MasWrapper masMagnetic;
        inputs.process_waveforms();

        OpenMagnetics::MagneticAdviser MagneticAdviser;
        // MagneticAdviser.set_interleaving_level(interleavingLevel);
        auto masMagnetics = MagneticAdviser.get_advised_magnetic(inputs, 1);

    }

    TEST(MagneticSimulatorJsonHV) {
        std::string masString = R"({"inputs": {"designRequirements": {"insulation": {"altitude": {"maximum": 1000 }, "cti": "Group IIIB", "pollutionDegree": "P2", "overvoltageCategory": "OVC-II", "insulationType": "Basic", "mainSupplyVoltage": {"nominal": null, "minimum": 100, "maximum": 815 }, "standards": ["IEC 60664-1"] }, "leakageInductance": [{"maximum": 0.0000027 }, {"maximum": 7.2e-7 } ], "magnetizingInductance": {"maximum": null, "minimum": null, "nominal": 0.0007 }, "market": "Commercial", "maximumDimensions": {"width": null, "height": 0.02, "depth": null }, "maximumWeight": null, "name": "My Design Requirements", "operatingTemperature": null, "strayCapacitance": [{"maximum": 5e-11 }, {"maximum": 5e-11 } ], "terminalType": ["Pin", "Pin", "Pin"], "topology": "Flyback Converter", "turnsRatios": [{"nominal": 3.6 }, {"nominal": 7 } ] }, "operatingPoints": [{"name": "Operating Point No. 1", "conditions": {"ambientTemperature": 42 }, "excitationsPerWinding": [{"name": "Primary winding excitation", "frequency": 42000, "current": {"waveform": {"ancillaryLabel": null, "data": [0, 0, 1.1, 0, 0 ], "numberPeriods": null, "time": [0, 0, 0.000007, 0.000007, 0.00002380952380952381 ] }, "processed": {"dutyCycle": 0.294, "peakToPeak": 1.1, "offset": 0, "label": "Flyback Primary", "acEffectiveFrequency": 320324.70197566116, "effectiveFrequency": 299906.6380380921, "peak": 1.0815263605442182, "rms": 0.34251379452955516, "thd": 1.070755363168311 }, "harmonics": {"amplitudes": [0.16053906914328236, 0.29202196202762337, 0.21752279286410783, 0.1310845319633303, 0.07713860380309742, 0.06991594662329052, 0.06385479128189217, 0.04886550825820873, 0.041656942163512685, 0.04106933856014564, 0.036071164493133245, 0.03055299653431604, 0.02975135660550652, 0.028391215457215468, 0.02482068925428346, 0.023301839916889198, 0.023120564125526488, 0.021217296242203084, 0.019422484452150467, 0.019302597014669035, 0.018564086064230358, 0.016990298638197066, 0.016530128240448857, 0.016408746965119517, 0.015342013775419296, 0.014571250724490458, 0.014600261585603161, 0.014080719038131833, 0.013228104677648548, 0.013112646237623088, 0.012998033401152062, 0.012300975273665412, 0.011953654437324483, 0.012016309039770377, 0.011608286047010533, 0.011111174591424324, 0.011137874398755002, 0.01101797292674616, 0.010530630511366074, 0.01040049906973778, 0.01046208177619542, 0.010124703775041825, 0.009838808475080322, 0.009931053977331523, 0.0098034018119726, 0.009456464631666566, 0.009454698580407995, 0.009502890216301076, 0.009218272478811467, 0.00907613407579727, 0.009199516076645192, 0.00906471876755199, 0.008824889331959554, 0.008907818118804589, 0.008937898630441313, 0.00869876368067147, 0.008666288051213203, 0.008803433740422266, 0.008663604885115571, 0.008515486625290338, 0.008660125560530002, 0.008670306514975606, 0.008475927879718145, 0.008536460912837853 ], "frequencies": [0, 42000, 84000, 126000, 168000, 210000, 252000, 294000, 336000, 378000, 420000, 462000, 504000, 546000, 588000, 630000, 672000, 714000, 756000, 798000, 840000, 882000, 924000, 966000, 1008000, 1050000, 1092000, 1134000, 1176000, 1218000, 1260000, 1302000, 1344000, 1386000, 1428000, 1470000, 1512000, 1554000, 1596000, 1638000, 1680000, 1722000, 1764000, 1806000, 1848000, 1890000, 1932000, 1974000, 2016000, 2058000, 2100000, 2142000, 2184000, 2226000, 2268000, 2310000, 2352000, 2394000, 2436000, 2478000, 2520000, 2562000, 2604000, 2646000 ] } }, "voltage": {"waveform": {"ancillaryLabel": null, "data": [-29.4, 70.6, 70.6, -29.4, -29.4 ], "numberPeriods": null, "time": [0, 0, 0.000007, 0.000007, 0.00002380952380952381 ] }, "processed": {"dutyCycle": 0.294, "peakToPeak": 100, "offset": 0, "label": "Rectangular", "acEffectiveFrequency": 273993.1760953399, "effectiveFrequency": 273985.04815560044, "peak": 70.6, "rms": 45.33538904652732, "thd": 0.7943280084778311 }, "harmonics": {"amplitudes": [0.4937500000000009, 50.19273146886441, 30.88945734421223, 8.60726309175931, 7.514577540357868, 12.576487416046705, 7.890222788854489, 0.6723406687769768, 6.659332230305735, 6.771471403422372, 2.1663923211140617, 3.134209960512532, 5.356728264586365, 3.4347141143172375, 0.6805380572551197, 3.777520625726094, 3.7722086912079633, 1.0283716619016732, 2.1769829843489013, 3.474177141872247, 2.1027712520453545, 0.6945565902694819, 2.7474727308098412, 2.608727438661375, 0.5486770349329464, 1.7724349572072589, 2.6198081625264167, 1.4623766283543616, 0.71496628279737, 2.2318766983434566, 1.995656440067472, 0.2773827898281461, 1.562500000000001, 2.1411881515502134, 1.0841275629577949, 0.7426431917434089, 1.9342807953981735, 1.620450382955772, 0.09545259242683589, 1.4471144811333827, 1.8430944173488684, 0.8315259963159228, 0.7788650462348548, 1.7521633971823452, 1.3695427043271637, 0.042929496561759636, 1.388303796831737, 1.6472150875774871, 0.6472086912079588, 0.8254655623504514, 1.6415464278026473, 1.1917877639027972, 0.16004318769545572, 1.3696996040394052, 1.5166136111631239, 0.5023333497836172, 0.8850851521101957, 1.581550490460967, 1.0607923422947243, 0.2691521002455623, 1.3846695378376832, 1.4323337135341552, 0.38011439553529425, 0.9615889729028446 ], "frequencies": [0, 42000, 84000, 126000, 168000, 210000, 252000, 294000, 336000, 378000, 420000, 462000, 504000, 546000, 588000, 630000, 672000, 714000, 756000, 798000, 840000, 882000, 924000, 966000, 1008000, 1050000, 1092000, 1134000, 1176000, 1218000, 1260000, 1302000, 1344000, 1386000, 1428000, 1470000, 1512000, 1554000, 1596000, 1638000, 1680000, 1722000, 1764000, 1806000, 1848000, 1890000, 1932000, 1974000, 2016000, 2058000, 2100000, 2142000, 2184000, 2226000, 2268000, 2310000, 2352000, 2394000, 2436000, 2478000, 2520000, 2562000, 2604000, 2646000 ] } } }, {"name": "Primary winding excitation", "frequency": 42000, "current": {"waveform": {"ancillaryLabel": null, "data": [0, 0, 3.96, 0, 0 ], "numberPeriods": null, "time": [0, 0.000011904761904761905, 0.000011904761904761905, 0.00002380952380952381, 0.00002380952380952381 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 3.96, "offset": 0, "label": "Flyback Secondary", "acEffectiveFrequency": 273605.22552591236, "effectiveFrequency": 239619.35667760254, "peak": 3.9599999999999986, "rms": 1.635596311125932, "thd": 0.6765065136547783 }, "harmonics": {"amplitudes": [1.0054687500000032, 1.5109819803933975, 0.6305067526445318, 0.43631079159665215, 0.3156335707813906, 0.25867345007829645, 0.2108457708927511, 0.1845098972167098, 0.15858039332900484, 0.14374429235357594, 0.12732519999086678, 0.11798991339580255, 0.1065764142034965, 0.10027664365108102, 0.09183268563443873, 0.08737513814977015, 0.08084358345172529, 0.0775829517661027, 0.07235909588115942, 0.06991721285428486, 0.06562943182065245, 0.06377074179801741, 0.060177659717708575, 0.05874824283059186, 0.05568602880656547, 0.054581360149729106, 0.051934759310085545, 0.0510815825974439, 0.0487670673260459, 0.048112679051860716, 0.04606818176826717, 0.04557382535330518, 0.043752232085917345, 0.04338887874386873, 0.04175376612752825, 0.04149933709574444, 0.04002209784539918, 0.03985958700992044, 0.038517442612831645, 0.03843361846308103, 0.03720821487910577, 0.037192705080064635, 0.03606910115775439, 0.036113735798427, 0.03507966215426201, 0.03517799562893598, 0.03422330356713118, 0.0343702622545533, 0.03348650869654576, 0.03367812888504953, 0.03285826032368028, 0.03309149205770409, 0.032329601799393176, 0.032602161771072315, 0.0318933023014623, 0.032203563952980456, 0.031543601457069734, 0.03189051394290526, 0.03127601564366044, 0.03165904576198601, 0.03108719333289207, 0.0315062863179612, 0.03097481051580278, 0.03143036691725387 ], "frequencies": [0, 42000, 84000, 126000, 168000, 210000, 252000, 294000, 336000, 378000, 420000, 462000, 504000, 546000, 588000, 630000, 672000, 714000, 756000, 798000, 840000, 882000, 924000, 966000, 1008000, 1050000, 1092000, 1134000, 1176000, 1218000, 1260000, 1302000, 1344000, 1386000, 1428000, 1470000, 1512000, 1554000, 1596000, 1638000, 1680000, 1722000, 1764000, 1806000, 1848000, 1890000, 1932000, 1974000, 2016000, 2058000, 2100000, 2142000, 2184000, 2226000, 2268000, 2310000, 2352000, 2394000, 2436000, 2478000, 2520000, 2562000, 2604000, 2646000 ] } }, "voltage": {"waveform": {"ancillaryLabel": null, "data": [-13.89, 13.89, 13.89, -13.89, -13.89 ], "numberPeriods": null, "time": [0, 0, 0.000011904761904761905, 0.000011904761904761905, 0.00002380952380952381 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 27.78, "offset": 0, "label": "Rectangular", "acEffectiveFrequency": 248423.92512497256, "effectiveFrequency": 248408.7565140517, "peak": 13.89, "rms": 13.890000000000022, "thd": 0.48331514845248535 }, "harmonics": {"amplitudes": [0.21703125, 17.681745968226167, 0.4340625, 5.884441743008607, 0.4340625, 3.5192857754085134, 0.4340625, 2.50156382659689, 0.4340625, 1.932968090534883, 0.4340625, 1.56850033166751, 0.4340625, 1.313925940874188, 0.4340625, 1.1252647178556892, 0.4340625, 0.9792293094780014, 0.4340625, 0.8623340820515439, 0.4340625, 0.7662274695502621, 0.4340625, 0.6854595927802318, 0.4340625, 0.6163213952979067, 0.4340625, 0.5561996920846202, 0.4340625, 0.5031990666519233, 0.4340625, 0.45591010107099894, 0.4340625, 0.41326185461487136, 0.4340625, 0.3744248874701925, 0.4340625, 0.33874569976854113, 0.4340625, 0.30570130348173624, 0.4340625, 0.2748670467095772, 0.4340625, 0.24589336899764186, 0.4340625, 0.21848870156913297, 0.4340625, 0.1924066733732579, 0.4340625, 0.16743638267205946, 0.4340625, 0.1433948809785266, 0.4340625, 0.12012127132032469, 0.4340625, 0.09747199388796957, 0.4340625, 0.07531698847858959, 0.4340625, 0.05353650312310587, 0.4340625, 0.03201837355771753, 0.4340625, 0.0106556362841701 ], "frequencies": [0, 42000, 84000, 126000, 168000, 210000, 252000, 294000, 336000, 378000, 420000, 462000, 504000, 546000, 588000, 630000, 672000, 714000, 756000, 798000, 840000, 882000, 924000, 966000, 1008000, 1050000, 1092000, 1134000, 1176000, 1218000, 1260000, 1302000, 1344000, 1386000, 1428000, 1470000, 1512000, 1554000, 1596000, 1638000, 1680000, 1722000, 1764000, 1806000, 1848000, 1890000, 1932000, 1974000, 2016000, 2058000, 2100000, 2142000, 2184000, 2226000, 2268000, 2310000, 2352000, 2394000, 2436000, 2478000, 2520000, 2562000, 2604000, 2646000 ] } } }, {"name": "Primary winding excitation", "frequency": 42000, "current": {"waveform": {"ancillaryLabel": null, "data": [0, 0, 0.08, 0, 0 ], "numberPeriods": null, "time": [0, 0.000011904761904761905, 0.000011904761904761905, 0.00002380952380952381, 0.00002380952380952381 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 0.08, "offset": 0, "label": "Flyback Secondary", "acEffectiveFrequency": 273605.2255259123, "effectiveFrequency": 239619.35667760245, "peak": 0.07999999999999997, "rms": 0.03304234971971578, "thd": 0.6765065136547783 }, "harmonics": {"amplitudes": [0.020312500000000067, 0.030524888492795912, 0.012737510154434986, 0.008814359426194993, 0.006376435773361427, 0.00522572626420801, 0.004259510523085881, 0.0037274726710446416, 0.0032036443096768643, 0.0029039250980520386, 0.0025722262624417523, 0.002383634614056616, 0.002153058872797908, 0.0020257907808299194, 0.0018552057703927027, 0.0017651543060559615, 0.0016332037060954627, 0.0015673323589111663, 0.0014617999167910994, 0.0014124689465512088, 0.001325847107487929, 0.0012882978141013626, 0.0012157102973274464, 0.001186833188496806, 0.001124970278920515, 0.0011026537403985668, 0.0010491870567694052, 0.0010319511635847236, 0.0009851932793140594, 0.000971973314179004, 0.0009306703387528712, 0.0009206833404708095, 0.0008838834764831795, 0.0008765430049266404, 0.0008435104268187535, 0.0008383704463786768, 0.000808527229199984, 0.0008052441820185946, 0.0007781301537945788, 0.0007764367366278998, 0.0007516811086688038, 0.0007513677793952459, 0.0007286687102576646, 0.0007295704201702419, 0.0007086800435204446, 0.0007106665783623426, 0.000691379870043054, 0.0006943487324152177, 0.0006764951251827419, 0.00068036624010201, 0.0006638032388622281, 0.0006685149910647295, 0.000653123268674609, 0.0006586295307287333, 0.0006443091374032789, 0.0006505770495551611, 0.0006372444738801973, 0.0006442528069273796, 0.0006318386998719282, 0.0006395766820603246, 0.0006280241077351936, 0.0006364906326860852, 0.0006257537477939952, 0.0006349569074192705 ], "frequencies": [0, 42000, 84000, 126000, 168000, 210000, 252000, 294000, 336000, 378000, 420000, 462000, 504000, 546000, 588000, 630000, 672000, 714000, 756000, 798000, 840000, 882000, 924000, 966000, 1008000, 1050000, 1092000, 1134000, 1176000, 1218000, 1260000, 1302000, 1344000, 1386000, 1428000, 1470000, 1512000, 1554000, 1596000, 1638000, 1680000, 1722000, 1764000, 1806000, 1848000, 1890000, 1932000, 1974000, 2016000, 2058000, 2100000, 2142000, 2184000, 2226000, 2268000, 2310000, 2352000, 2394000, 2436000, 2478000, 2520000, 2562000, 2604000, 2646000 ] } }, "voltage": {"waveform": {"ancillaryLabel": null, "data": [-7.14, 7.14, 7.14, -7.14, -7.14 ], "numberPeriods": null, "time": [0, 0, 0.000011904761904761905, 0.000011904761904761905, 0.00002380952380952381 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 14.28, "offset": 0, "label": "Rectangular", "acEffectiveFrequency": 248423.9251249721, "effectiveFrequency": 248408.75651405123, "peak": 7.14, "rms": 7.139999999999993, "thd": 0.4833151484524845 }, "harmonics": {"amplitudes": [0.1115625, 9.08910483895859, 0.223125, 3.0248318246998886, 0.223125, 1.8090497074454124, 0.223125, 1.2859010598921377, 0.223125, 0.9936207463224668, 0.223125, 0.8062701488917218, 0.223125, 0.6754090149634054, 0.223125, 0.5784298117703113, 0.223125, 0.5033619344616945, 0.223125, 0.44327324304161464, 0.223125, 0.3938707078897675, 0.223125, 0.3523528792261233, 0.223125, 0.3168131578421202, 0.223125, 0.285908265045658, 0.223125, 0.2586638830737746, 0.223125, 0.23435551631727392, 0.223125, 0.21243265960764457, 0.223125, 0.19246894863478564, 0.223125, 0.1741284590602866, 0.223125, 0.1571423547055144, 0.223125, 0.14129234798462062, 0.223125, 0.1263987512342087, 0.223125, 0.1123116867677183, 0.223125, 0.09890451028690123, 0.223125, 0.08606881009924447, 0.223125, 0.07371054356995504, 0.223125, 0.0617470034000806, 0.223125, 0.05010439426638574, 0.223125, 0.0387158601682599, 0.223125, 0.027519843938011213, 0.223125, 0.016458688783449027, 0.223125, 0.005477411308063118 ], "frequencies": [0, 42000, 84000, 126000, 168000, 210000, 252000, 294000, 336000, 378000, 420000, 462000, 504000, 546000, 588000, 630000, 672000, 714000, 756000, 798000, 840000, 882000, 924000, 966000, 1008000, 1050000, 1092000, 1134000, 1176000, 1218000, 1260000, 1302000, 1344000, 1386000, 1428000, 1470000, 1512000, 1554000, 1596000, 1638000, 1680000, 1722000, 1764000, 1806000, 1848000, 1890000, 1932000, 1974000, 2016000, 2058000, 2100000, 2142000, 2184000, 2226000, 2268000, 2310000, 2352000, 2394000, 2436000, 2478000, 2520000, 2562000, 2604000, 2646000 ] } } } ] } ] }, "magnetic": {"coil": {"functionalDescription": [{"name": "Primary"}, {"name": "Secondary"}, {"name": "Tertiary"} ] } } })";
        json masJson = json::parse(masString);

        if (masJson["inputs"]["designRequirements"]["insulation"]["cti"] == "GROUP_IIIa") {
            masJson["inputs"]["designRequirements"]["insulation"]["cti"] = "GROUP_IIIA";
        }
        if (masJson["inputs"]["designRequirements"]["insulation"]["cti"] == "GROUP_IIIb") {
            masJson["inputs"]["designRequirements"]["insulation"]["cti"] = "GROUP_IIIB";
        }

        OpenMagnetics::InputsWrapper inputs(masJson["inputs"]);
        OpenMagnetics::MasWrapper masMagnetic;
        // inputs.process_waveforms();

        OpenMagnetics::MagneticAdviser MagneticAdviser;
        // MagneticAdviser.set_interleaving_level(interleavingLevel);
        auto masMagnetics = MagneticAdviser.get_advised_magnetic(inputs, 1);

        for (size_t i = 0; i < masMagnetics.size(); ++i){
            auto simulatedMas = masMagnetics[i].first;
            auto outputFilePath = std::filesystem::path{ __FILE__ }.parent_path().append("..").append("output");
            auto outFile = outputFilePath;
            std::string filename = "MagneticSimulator_" + std::to_string(i) + "_" + simulatedMas.get_mutable_magnetic().get_mutable_core().get_shape_name() + ".svg";
            filename = std::filesystem::path(std::regex_replace(std::string(filename), std::regex(" "), "_")).string();
            filename = std::filesystem::path(std::regex_replace(std::string(filename), std::regex("/"), "_")).string();

            outFile.append(filename);
            OpenMagnetics::Painter painter(outFile);
            auto settings = OpenMagnetics::Settings::GetInstance();
            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);

            settings->set_painter_number_points_x(20);
            settings->set_painter_number_points_y(20);

            settings->set_painter_include_fringing(false);
            settings->set_painter_mirroring_dimension(0);
            painter.paint_magnetic_field(inputs.get_operating_point(0), simulatedMas.get_mutable_magnetic());
            painter.paint_core(simulatedMas.get_mutable_magnetic());
            painter.paint_bobbin(simulatedMas.get_mutable_magnetic());
            painter.paint_coil_turns(simulatedMas.get_mutable_magnetic());
            painter.export_svg();
        }

    }


    TEST(MagneticSimulatorJsonLV) {
        std::string masString = R"({"inputs": {"designRequirements": {"insulation": {"altitude": {"maximum": 1000 }, "cti": "Group IIIB", "pollutionDegree": "P2", "overvoltageCategory": "OVC-II", "insulationType": "Basic", "mainSupplyVoltage": {"nominal": 120, "minimum": 20, "maximum": 450 }, "standards": ["IEC 60664-1"] }, "leakageInductance": [{"maximum": 0.00000135 }, {"maximum": 0.00000135 } ], "magnetizingInductance": {"maximum": 0.000088, "minimum": 0.000036, "nominal": 0.000039999999999999996 }, "market": "Commercial", "maximumDimensions": {"width": null, "height": 0.02, "depth": null }, "maximumWeight": null, "name": "My Design Requirements", "operatingTemperature": null, "strayCapacitance": [{"maximum": 5e-11 }, {"maximum": 5e-11 } ], "terminalType": ["Pin", "Pin", "Pin"], "topology": "Flyback Converter", "turnsRatios": [{"nominal": 1.2 }, {"nominal": 1.2 } ] }, "operatingPoints": [{"name": "Operating Point No. 1", "conditions": {"ambientTemperature": 42 }, "excitationsPerWinding": [{"name": "Primary winding excitation", "frequency": 36000, "current": {"waveform": {"ancillaryLabel": null, "data": [0, 0, 5.5, 0, 0 ], "numberPeriods": null, "time": [0, 0, 0.000011111111111111112, 0.000011111111111111112, 0.00002777777777777778 ] }, "processed": {"dutyCycle": 0.4, "peakToPeak": 5.5, "offset": 0, "label": "Flyback Primary", "acEffectiveFrequency": 247671.20334838802, "effectiveFrequency": 224591.09893738205, "peak": 5.478515625000006, "rms": 2.025897603604934, "thd": 0.8123116860415294 }, "harmonics": {"amplitudes": [1.1128234863281259, 1.8581203560604207, 1.051281221517565, 0.5159082238421047, 0.4749772671818343, 0.35101798151542746, 0.28680520988943464, 0.26606329358167974, 0.2109058168232097, 0.2038324242201338, 0.17683391011628416, 0.15977271740890614, 0.15330090420784062, 0.13359870506402888, 0.1311678604251054, 0.11938227872282572, 0.11196939263234992, 0.10881687126769939, 0.09881440376099933, 0.09781517962337143, 0.09113803697574208, 0.08720137281111257, 0.08534603089826898, 0.07933100843010468, 0.07894777491614259, 0.0746052794656816, 0.07229734773884018, 0.07109041486606842, 0.0670974294019412, 0.06703716258861198, 0.06396085871081211, 0.0625474905371643, 0.06171647321147238, 0.05889230550248535, 0.059028047581821314, 0.05671822612277054, 0.05585484049699437, 0.055265364667603324, 0.0531817689812044, 0.053452567468547284, 0.05164394009764037, 0.051150939884780554, 0.05072953903613357, 0.049149522805038266, 0.049525208170729855, 0.04806384343218855, 0.04784167797419847, 0.047545488047249944, 0.04632889186784806, 0.046795775944523485, 0.045586400651502844, 0.045578916197115495, 0.045382141359988915, 0.04444264358178238, 0.04499725549277023, 0.04397809673849301, 0.04415534166549457, 0.044042673430388084, 0.04332652563384539, 0.04397294643650677, 0.043102730085842, 0.043452676225114936, 0.04341597260904029, 0.04289100286968138 ], "frequencies": [0, 36000, 72000, 108000, 144000, 180000, 216000, 252000, 288000, 324000, 360000, 396000, 432000, 468000, 504000, 540000, 576000, 612000, 648000, 684000, 720000, 756000, 792000, 828000, 864000, 900000, 936000, 972000, 1008000, 1044000, 1080000, 1116000, 1152000, 1188000, 1224000, 1260000, 1296000, 1332000, 1368000, 1404000, 1440000, 1476000, 1512000, 1548000, 1584000, 1620000, 1656000, 1692000, 1728000, 1764000, 1800000, 1836000, 1872000, 1908000, 1944000, 1980000, 2016000, 2052000, 2088000, 2124000, 2160000, 2196000, 2232000, 2268000 ] } }, "voltage": {"waveform": {"ancillaryLabel": null, "data": [-8, 12, 12, -8, -8 ], "numberPeriods": null, "time": [0, 0, 0.000011111111111111112, 0.000011111111111111112, 0.00002777777777777778 ] }, "processed": {"dutyCycle": 0.4, "peakToPeak": 20, "offset": 0, "label": "Rectangular", "acEffectiveFrequency": 217445.61780293446, "effectiveFrequency": 217445.06394458748, "peak": 12, "rms": 9.79157801378307, "thd": 0.5579294461931013 }, "harmonics": {"amplitudes": [0.03125, 12.090982167347164, 3.7938629699811433, 2.4460154592542187, 3.050934294867692, 0.06265085868474476, 2.0052584267980813, 1.1245773748206938, 0.8899247078195547, 1.3746157728063957, 0.06310658027096225, 1.0931619934351904, 0.682943044655975, 0.5329821111108219, 0.8998037891938968, 0.06387675236155328, 0.7544417382415929, 0.5036912732460003, 0.37575767434186663, 0.6781566555968945, 0.06497787099509279, 0.579613707579126, 0.4082105683349906, 0.28790910341678466, 0.5516771452281819, 0.06643416431010025, 0.4742269329016237, 0.35024440150573616, 0.23220844850577863, 0.4713901788294872, 0.0682788501833682, 0.40480954492681936, 0.3125, 0.19399945657286152, 0.41719035005974064, 0.07055595095604376, 0.35652867811806305, 0.28709106236926035, 0.16634675530328177, 0.3793488450042862, 0.07332285477181877, 0.32183350571658953, 0.2699539504381825, 0.14554626367323475, 0.3526337777044684, 0.0766539126369276, 0.29650814745710025, 0.25883312123614344, 0.12944173824159266, 0.33403609127672834, 0.08064551519955634, 0.27805045130481554, 0.25243555700995646, 0.1166943265232067, 0.3217665194149353, 0.08542334196565987, 0.2649247078195551, 0.250039428516803, 0.10643002348369442, 0.31477312120987916, 0.09115288771096393, 0.25618941041585475, 0.2513050615401854, 0.098055076230366 ], "frequencies": [0, 36000, 72000, 108000, 144000, 180000, 216000, 252000, 288000, 324000, 360000, 396000, 432000, 468000, 504000, 540000, 576000, 612000, 648000, 684000, 720000, 756000, 792000, 828000, 864000, 900000, 936000, 972000, 1008000, 1044000, 1080000, 1116000, 1152000, 1188000, 1224000, 1260000, 1296000, 1332000, 1368000, 1404000, 1440000, 1476000, 1512000, 1548000, 1584000, 1620000, 1656000, 1692000, 1728000, 1764000, 1800000, 1836000, 1872000, 1908000, 1944000, 1980000, 2016000, 2052000, 2088000, 2124000, 2160000, 2196000, 2232000, 2268000 ] } } }, {"name": "Primary winding excitation", "frequency": 36000, "current": {"waveform": {"ancillaryLabel": null, "data": [0, 0, 6.6, 0, 0 ], "numberPeriods": null, "time": [0, 0.00001388888888888889, 0.00001388888888888889, 0.00002777777777777778, 0.00002777777777777778 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 6.6, "offset": 0, "label": "Flyback Secondary", "acEffectiveFrequency": 234518.76473649617, "effectiveFrequency": 205388.02000937346, "peak": 6.599999999999992, "rms": 2.7259938518765505, "thd": 0.6765065136547781 }, "harmonics": {"amplitudes": [1.6757812500000036, 2.5183033006556617, 1.0508445877408874, 0.7271846526610849, 0.5260559513023173, 0.43112241679715924, 0.35140961815458516, 0.30751649536118214, 0.2643006555483416, 0.23957382058929272, 0.21220866665144478, 0.19664985565967041, 0.17762735700582763, 0.16712773941846806, 0.15305447605739808, 0.14562523024961643, 0.13473930575287565, 0.12930491961017093, 0.12059849313526576, 0.11652868809047452, 0.10938238636775419, 0.10628456966336206, 0.10029609952951436, 0.0979137380509861, 0.09281004801094254, 0.09096893358288156, 0.08655793218347599, 0.08513597099573951, 0.08127844554340995, 0.08018779841976777, 0.07678030294711186, 0.07595637558884157, 0.07292038680986246, 0.07231479790644763, 0.06958961021254718, 0.06916556182624073, 0.06670349640899874, 0.06643264501653386, 0.06419573768805274, 0.06405603077180153, 0.062013691465176275, 0.0619878418001075, 0.060115168596257366, 0.060189559664044844, 0.058466103590436726, 0.05862999271489314, 0.05703883927855185, 0.05728377042425536, 0.05581084782757627, 0.05613021480841572, 0.054763767206133816, 0.05515248676284005, 0.05388266966565528, 0.05433693628512042, 0.05315550383577058, 0.05367260658830061, 0.05257266909511635, 0.05315085657150875, 0.052126692739434176, 0.05276507626997662, 0.05181198888815346, 0.05251047719660189, 0.051624684193004804, 0.05238394486208969 ], "frequencies": [0, 36000, 72000, 108000, 144000, 180000, 216000, 252000, 288000, 324000, 360000, 396000, 432000, 468000, 504000, 540000, 576000, 612000, 648000, 684000, 720000, 756000, 792000, 828000, 864000, 900000, 936000, 972000, 1008000, 1044000, 1080000, 1116000, 1152000, 1188000, 1224000, 1260000, 1296000, 1332000, 1368000, 1404000, 1440000, 1476000, 1512000, 1548000, 1584000, 1620000, 1656000, 1692000, 1728000, 1764000, 1800000, 1836000, 1872000, 1908000, 1944000, 1980000, 2016000, 2052000, 2088000, 2124000, 2160000, 2196000, 2232000, 2268000 ] } }, "voltage": {"waveform": {"ancillaryLabel": null, "data": [-8.335, 8.335, 8.335, -8.335, -8.335 ], "numberPeriods": null, "time": [0, 0, 0.00001388888888888889, 0.00001388888888888889, 0.00002777777777777778 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 16.67, "offset": 0, "label": "Rectangular", "acEffectiveFrequency": 212934.79296426187, "effectiveFrequency": 212921.79129775826, "peak": 8.335, "rms": 8.33500000000001, "thd": 0.48331514845248513 }, "harmonics": {"amplitudes": [0.130234375, 10.610320564806702, 0.26046875, 3.531088691718988, 0.26046875, 2.1118248335514735, 0.26046875, 1.5011183941457937, 0.26046875, 1.1599200168904427, 0.26046875, 0.9412131219905466, 0.26046875, 0.7884501596246478, 0.26046875, 0.6752398432920929, 0.26046875, 0.587608084557174, 0.26046875, 0.5174625323181874, 0.26046875, 0.4597916456948479, 0.26046875, 0.4113251048108877, 0.26046875, 0.36983720876947807, 0.26046875, 0.333759858425148, 0.26046875, 0.3019556674257579, 0.26046875, 0.2735788835440449, 0.26046875, 0.24798686524225744, 0.26046875, 0.2246818889174983, 0.26046875, 0.20327180760048874, 0.26046875, 0.18344279082219334, 0.26046875, 0.16494001687000165, 0.26046875, 0.14755372430492025, 0.26046875, 0.1311089508695984, 0.26046875, 0.1154578561962637, 0.26046875, 0.10047388405843227, 0.26046875, 0.0860472521926578, 0.26046875, 0.0720814108318868, 0.26046875, 0.058490213754947895, 0.26046875, 0.04519561547653339, 0.26046875, 0.032125756193742694, 0.26046875, 0.019213329273115587, 0.26046875, 0.006394148914942832 ], "frequencies": [0, 36000, 72000, 108000, 144000, 180000, 216000, 252000, 288000, 324000, 360000, 396000, 432000, 468000, 504000, 540000, 576000, 612000, 648000, 684000, 720000, 756000, 792000, 828000, 864000, 900000, 936000, 972000, 1008000, 1044000, 1080000, 1116000, 1152000, 1188000, 1224000, 1260000, 1296000, 1332000, 1368000, 1404000, 1440000, 1476000, 1512000, 1548000, 1584000, 1620000, 1656000, 1692000, 1728000, 1764000, 1800000, 1836000, 1872000, 1908000, 1944000, 1980000, 2016000, 2052000, 2088000, 2124000, 2160000, 2196000, 2232000, 2268000 ] } } }, {"name": "Primary winding excitation", "frequency": 36000, "current": {"waveform": {"ancillaryLabel": null, "data": [0, 0, 0.08, 0, 0 ], "numberPeriods": null, "time": [0, 0.00001388888888888889, 0.00001388888888888889, 0.00002777777777777778, 0.00002777777777777778 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 0.08, "offset": 0, "label": "Flyback Secondary", "acEffectiveFrequency": 234518.7647364962, "effectiveFrequency": 205388.02000937346, "peak": 0.0799999999999999, "rms": 0.033042349719715765, "thd": 0.6765065136547783 }, "harmonics": {"amplitudes": [0.020312500000000046, 0.030524888492795898, 0.012737510154435002, 0.008814359426194969, 0.006376435773361423, 0.005225726264207993, 0.004259510523085882, 0.003727472671044633, 0.0032036443096768678, 0.0029039250980520334, 0.002572226262441755, 0.002383634614056611, 0.0021530588727979106, 0.0020257907808299163, 0.001855205770392704, 0.0017651543060559591, 0.0016332037060954637, 0.0015673323589111632, 0.0014617999167910998, 0.0014124689465512055, 0.0013258471074879294, 0.0012882978141013591, 0.0012157102973274472, 0.0011868331884968021, 0.0011249702789205155, 0.0011026537403985642, 0.0010491870567694056, 0.0010319511635847216, 0.0009851932793140603, 0.0009719733141790018, 0.0009306703387528721, 0.0009206833404708108, 0.0008838834764831795, 0.0008765430049266376, 0.0008435104268187531, 0.0008383704463786751, 0.0008085272291999843, 0.0008052441820185928, 0.0007781301537945793, 0.0007764367366278984, 0.0007516811086688035, 0.0007513677793952425, 0.0007286687102576648, 0.0007295704201702394, 0.0007086800435204447, 0.0007106665783623409, 0.0006913798700430537, 0.0006943487324152148, 0.0006764951251827443, 0.0006803662401020098, 0.0006638032388622283, 0.0006685149910647278, 0.0006531232686746098, 0.0006586295307287323, 0.0006443091374032788, 0.0006505770495551569, 0.0006372444738801973, 0.0006442528069273779, 0.0006318386998719287, 0.0006395766820603229, 0.0006280241077351938, 0.0006364906326860843, 0.0006257537477939962, 0.0006349569074192687 ], "frequencies": [0, 36000, 72000, 108000, 144000, 180000, 216000, 252000, 288000, 324000, 360000, 396000, 432000, 468000, 504000, 540000, 576000, 612000, 648000, 684000, 720000, 756000, 792000, 828000, 864000, 900000, 936000, 972000, 1008000, 1044000, 1080000, 1116000, 1152000, 1188000, 1224000, 1260000, 1296000, 1332000, 1368000, 1404000, 1440000, 1476000, 1512000, 1548000, 1584000, 1620000, 1656000, 1692000, 1728000, 1764000, 1800000, 1836000, 1872000, 1908000, 1944000, 1980000, 2016000, 2052000, 2088000, 2124000, 2160000, 2196000, 2232000, 2268000 ] } }, "voltage": {"waveform": {"ancillaryLabel": null, "data": [-8.335, 8.335, 8.335, -8.335, -8.335 ], "numberPeriods": null, "time": [0, 0, 0.00001388888888888889, 0.00001388888888888889, 0.00002777777777777778 ] }, "processed": {"dutyCycle": 0.5, "peakToPeak": 16.67, "offset": 0, "label": "Rectangular", "acEffectiveFrequency": 212934.79296426187, "effectiveFrequency": 212921.79129775826, "peak": 8.335, "rms": 8.33500000000001, "thd": 0.48331514845248513 }, "harmonics": {"amplitudes": [0.130234375, 10.610320564806702, 0.26046875, 3.531088691718988, 0.26046875, 2.1118248335514735, 0.26046875, 1.5011183941457937, 0.26046875, 1.1599200168904427, 0.26046875, 0.9412131219905466, 0.26046875, 0.7884501596246478, 0.26046875, 0.6752398432920929, 0.26046875, 0.587608084557174, 0.26046875, 0.5174625323181874, 0.26046875, 0.4597916456948479, 0.26046875, 0.4113251048108877, 0.26046875, 0.36983720876947807, 0.26046875, 0.333759858425148, 0.26046875, 0.3019556674257579, 0.26046875, 0.2735788835440449, 0.26046875, 0.24798686524225744, 0.26046875, 0.2246818889174983, 0.26046875, 0.20327180760048874, 0.26046875, 0.18344279082219334, 0.26046875, 0.16494001687000165, 0.26046875, 0.14755372430492025, 0.26046875, 0.1311089508695984, 0.26046875, 0.1154578561962637, 0.26046875, 0.10047388405843227, 0.26046875, 0.0860472521926578, 0.26046875, 0.0720814108318868, 0.26046875, 0.058490213754947895, 0.26046875, 0.04519561547653339, 0.26046875, 0.032125756193742694, 0.26046875, 0.019213329273115587, 0.26046875, 0.006394148914942832 ], "frequencies": [0, 36000, 72000, 108000, 144000, 180000, 216000, 252000, 288000, 324000, 360000, 396000, 432000, 468000, 504000, 540000, 576000, 612000, 648000, 684000, 720000, 756000, 792000, 828000, 864000, 900000, 936000, 972000, 1008000, 1044000, 1080000, 1116000, 1152000, 1188000, 1224000, 1260000, 1296000, 1332000, 1368000, 1404000, 1440000, 1476000, 1512000, 1548000, 1584000, 1620000, 1656000, 1692000, 1728000, 1764000, 1800000, 1836000, 1872000, 1908000, 1944000, 1980000, 2016000, 2052000, 2088000, 2124000, 2160000, 2196000, 2232000, 2268000 ] } } } ] } ] }, "magnetic": {"coil": {"functionalDescription": [{"name": "Primary"}, {"name": "Secondary"}, {"name": "Tertiary"} ] } } })";
        json masJson = json::parse(masString);

        if (masJson["inputs"]["designRequirements"]["insulation"]["cti"] == "GROUP_IIIa") {
            masJson["inputs"]["designRequirements"]["insulation"]["cti"] = "GROUP_IIIA";
        }
        if (masJson["inputs"]["designRequirements"]["insulation"]["cti"] == "GROUP_IIIb") {
            masJson["inputs"]["designRequirements"]["insulation"]["cti"] = "GROUP_IIIB";
        }

        OpenMagnetics::InputsWrapper inputs(masJson["inputs"]);
        OpenMagnetics::MasWrapper masMagnetic;
        // inputs.process_waveforms();

        OpenMagnetics::MagneticAdviser MagneticAdviser;
        // MagneticAdviser.set_interleaving_level(interleavingLevel);
        auto masMagnetics = MagneticAdviser.get_advised_magnetic(inputs, 1);

        for (size_t i = 0; i < masMagnetics.size(); ++i){
            auto simulatedMas = masMagnetics[i].first;
            auto outputFilePath = std::filesystem::path{ __FILE__ }.parent_path().append("..").append("output");
            auto outFile = outputFilePath;
            std::string filename = "MagneticSimulator_" + std::to_string(i) + "_" + simulatedMas.get_mutable_magnetic().get_mutable_core().get_shape_name() + ".svg";
            filename = std::filesystem::path(std::regex_replace(std::string(filename), std::regex(" "), "_")).string();
            filename = std::filesystem::path(std::regex_replace(std::string(filename), std::regex("/"), "_")).string();

            outFile.append(filename);
            OpenMagnetics::Painter painter(outFile);
            auto settings = OpenMagnetics::Settings::GetInstance();

            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);
            settings->set_painter_number_points_x(20);
            settings->set_painter_number_points_y(20);
            settings->set_painter_include_fringing(false);
            settings->set_painter_mirroring_dimension(0);
            painter.paint_magnetic_field(inputs.get_operating_point(0), simulatedMas.get_mutable_magnetic());
            painter.paint_core(simulatedMas.get_mutable_magnetic());
            painter.paint_bobbin(simulatedMas.get_mutable_magnetic());
            painter.paint_coil_turns(simulatedMas.get_mutable_magnetic());
            painter.export_svg();
        }

    }

    TEST(Test_IEEE_Article_Simulation_0) {

        double temperature = 20;
        std::vector<int64_t> numberTurns = {16, 1};
        std::vector<int64_t> numberParallels = {2, 1};
        std::vector<double> turnsRatios = {16};
        std::string shapeName = "PQ 35/35";
        uint8_t interleavingLevel = 1;
        auto windingOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto layersOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto turnsAlignment = OpenMagnetics::CoilAlignment::SPREAD;
        auto sectionsAlignment = OpenMagnetics::CoilAlignment::CENTERED;

        std::vector<OpenMagnetics::WireWrapper> wires;
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_strand("Round 0.1 - Grade 1");
            wire.set_nominal_value_outer_diameter(0.001);
            wire.set_number_conductors(45);
            wire.set_type(OpenMagnetics::WireType::LITZ);
            OpenMagnetics::InsulationWireCoating coating;
            coating.set_type(OpenMagnetics::InsulationWireCoatingType::SERVED);
            coating.set_number_layers(1);
            wire.set_coating(coating);
            wires.push_back(wire);
        }
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_nominal_value_conducting_width(0.0005);
            wire.set_nominal_value_conducting_height(0.020);
            wire.set_nominal_value_outer_width(0.00053);
            wire.set_nominal_value_outer_height(0.020);
            wire.set_number_conductors(1);
            wire.set_material("copper");
            wire.set_type(OpenMagnetics::WireType::FOIL);
            wires.push_back(wire);
        }

        auto coil = OpenMagneticsTesting::get_quick_coil(numberTurns,
                                                         numberParallels,
                                                         shapeName,
                                                         interleavingLevel,
                                                         windingOrientation,
                                                         layersOrientation,
                                                         turnsAlignment,
                                                         sectionsAlignment,
                                                         wires,
                                                         true);

        coil.wind({0, 1, 0}, 1);

        int64_t numberStacks = 1;
        std::string coreMaterial = "3C90";
        auto gapping = OpenMagneticsTesting::get_ground_gap(0.00020);
        auto core = OpenMagneticsTesting::get_quick_core(shapeName, gapping, numberStacks, coreMaterial);
        OpenMagnetics::Magnetic magnetic;
        magnetic.set_core(core);
        magnetic.set_coil(coil);

        json inputsJson;

        inputsJson["operatingPoints"] = json::array();
        json operatingPointJson = json();
        operatingPointJson["name"] = "Nominal";
        operatingPointJson["conditions"] = json();
        operatingPointJson["conditions"]["ambientTemperature"] = 85;

        operatingPointJson["excitationsPerWinding"] = json::array();
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 115000;
            windingExcitation["current"]["processed"]["label"] = "Sinusoidal";
            windingExcitation["current"]["processed"]["peakToPeak"] = 4 * 2;
            windingExcitation["current"]["processed"]["offset"] = 0;
            windingExcitation["current"]["processed"]["dutyCycle"] = 0.5;
            windingExcitation["voltage"]["processed"]["label"] = "Rectangular";
            windingExcitation["voltage"]["processed"]["peakToPeak"] = 380;
            windingExcitation["voltage"]["processed"]["offset"] = 0;
            windingExcitation["voltage"]["processed"]["dutyCycle"] = 0.5;
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 115000;
            windingExcitation["current"]["processed"]["label"] = "Sinusoidal";
            windingExcitation["current"]["processed"]["peakToPeak"] = 64 * 2;
            windingExcitation["current"]["processed"]["offset"] = 0;
            windingExcitation["current"]["processed"]["dutyCycle"] = 0.5;
            windingExcitation["voltage"]["processed"]["label"] = "Rectangular";
            windingExcitation["voltage"]["processed"]["peakToPeak"] = 24;
            windingExcitation["voltage"]["processed"]["offset"] = 0;
            windingExcitation["voltage"]["processed"]["dutyCycle"] = 0.5;
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        inputsJson["operatingPoints"].push_back(operatingPointJson);

        inputsJson["designRequirements"] = json();
        inputsJson["designRequirements"]["magnetizingInductance"]["nominal"] = 200e-6;
        inputsJson["designRequirements"]["turnsRatios"] = json::array();
        inputsJson["designRequirements"]["turnsRatios"].push_back(16);

        OpenMagnetics::InputsWrapper inputs(inputsJson);



        auto windingLosses = OpenMagnetics::WindingLosses().calculate_losses(magnetic, inputs.get_operating_point(0), temperature);
        json windingLossesJson;
        to_json(windingLossesJson, windingLosses);
        // std::cout << windingLossesJson << std::endl;

        auto simulator = OpenMagnetics::MagneticSimulator();
        auto operatingPoint = inputs.get_operating_point(0);
        auto coreLosses = simulator.calculate_core_losses(operatingPoint, magnetic);
        auto mas = simulator.simulate(inputs, magnetic);
        json coreLossesJson;
        to_json(coreLossesJson, coreLosses);
        // std::cout << coreLossesJson << std::endl;

        OpenMagnetics::MagneticAdviser::preview_magnetic(mas);

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_0.mas.json");
            OpenMagnetics::to_file(outFile, mas);
        }


        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_0_Waveform_Primary_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_0_Waveform_Primary_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_0_Waveform_Secondaty_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_0_Waveform_Secondaty_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_0.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, true);

            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);
            settings->set_painter_number_points_x(100);
            settings->set_painter_number_points_y(100);
            // settings->set_painter_maximum_value_colorbar(5000);
            // settings->set_painter_minimum_value_colorbar(500);
            settings->set_painter_logarithmic_scale(true);
            settings->set_painter_include_fringing(true);

            painter.paint_magnetic_field(inputs.get_operating_point(0), magnetic);
            painter.paint_core(magnetic);
            painter.paint_bobbin(magnetic);
            painter.paint_coil_turns(magnetic);
            painter.export_svg();
            settings->reset();
        }
    }

    TEST(Test_IEEE_Article_Simulation_1) {

        double temperature = 20;
        std::vector<int64_t> numberTurns = {18, 11};
        std::vector<int64_t> numberParallels = {1, 2};
        std::vector<double> turnsRatios = {16};
        std::string shapeName = "PQ 65/44";
        uint8_t interleavingLevel = 1;
        auto windingOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto layersOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto turnsAlignment = OpenMagnetics::CoilAlignment::SPREAD;
        auto sectionsAlignment = OpenMagnetics::CoilAlignment::CENTERED;

        std::vector<OpenMagnetics::WireWrapper> wires;
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_strand("Round 0.05 - Grade 1");
            wire.set_nominal_value_outer_diameter(OpenMagnetics::WireWrapper::get_outer_diameter_insulated_litz(0.00005, 900, 3, 5.08e-05));
            wire.set_number_conductors(900);
            wire.set_type(OpenMagnetics::WireType::LITZ);
            OpenMagnetics::InsulationWireCoating coating;
            coating.set_type(OpenMagnetics::InsulationWireCoatingType::INSULATED);
            coating.set_number_layers(3);
            coating.set_material("ETFE");
            coating.set_thickness_layers(5.08e-05);
            coating.set_temperature_rating(155);
            coating.set_breakdown_voltage(9000);
            wire.set_coating(coating);
            wires.push_back(wire);
        }
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_strand("Round 0.05 - Grade 1");
            wire.set_nominal_value_outer_diameter(OpenMagnetics::WireWrapper::get_outer_diameter_served_litz(0.00005, 720, 1, 1));
            wire.set_number_conductors(800);
            wire.set_type(OpenMagnetics::WireType::LITZ);
            OpenMagnetics::InsulationWireCoating coating;
            coating.set_type(OpenMagnetics::InsulationWireCoatingType::SERVED);
            coating.set_number_layers(1);
            wire.set_coating(coating);
            wires.push_back(wire);
        }

        auto coil = OpenMagneticsTesting::get_quick_coil(numberTurns,
                                                         numberParallels,
                                                         shapeName,
                                                         interleavingLevel,
                                                         windingOrientation,
                                                         layersOrientation,
                                                         turnsAlignment,
                                                         sectionsAlignment,
                                                         wires,
                                                         true);

        coil.wind({0, 1, 0}, 1);

        int64_t numberStacks = 1;
        std::string coreMaterial = "3C97";
        auto gapping = OpenMagneticsTesting::get_ground_gap(0.00001);
        auto core = OpenMagneticsTesting::get_quick_core(shapeName, gapping, numberStacks, coreMaterial);
        OpenMagnetics::Magnetic magnetic;
        magnetic.set_core(core);
        magnetic.set_coil(coil);

        json inputsJson;

        inputsJson["operatingPoints"] = json::array();
        json operatingPointJson = json();
        operatingPointJson["name"] = "Nominal";
        operatingPointJson["conditions"] = json();
        operatingPointJson["conditions"]["ambientTemperature"] = 20;

        operatingPointJson["excitationsPerWinding"] = json::array();
        // {
        //     json windingExcitation = json();
        //     windingExcitation["frequency"] = 100000;
        //     windingExcitation["current"]["waveform"]["data"] = {0, 17.5, 22.5, -17.5, -22.5, 0};
        //     windingExcitation["current"]["waveform"]["time"] = {0, 0, 0.000005, 0.000005, 0.00001, 0.00001};
        //     windingExcitation["voltage"]["waveform"]["data"] = {800, 800, -800, -800, 800};
        //     windingExcitation["voltage"]["waveform"]["time"] = {0, 0.000005, 0.000005, 0.00001, 0.00001};
        //     operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        // }


        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 100000;
            windingExcitation["current"]["processed"]["label"] = "Sinusoidal";
            windingExcitation["current"]["processed"]["peakToPeak"] = 22.5 * 2;
            windingExcitation["current"]["processed"]["offset"] = 0;
            windingExcitation["current"]["processed"]["dutyCycle"] = 0.5;
            windingExcitation["voltage"]["processed"]["label"] = "Rectangular";
            windingExcitation["voltage"]["processed"]["peakToPeak"] = 1600;
            windingExcitation["voltage"]["processed"]["offset"] = 0;
            windingExcitation["voltage"]["processed"]["dutyCycle"] = 0.5;
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }

        inputsJson["operatingPoints"].push_back(operatingPointJson);

        inputsJson["designRequirements"] = json();
        inputsJson["designRequirements"]["magnetizingInductance"]["nominal"] = 720e-6;
        inputsJson["designRequirements"]["turnsRatios"] = json::array();
        json turnRatioSecondary;
        turnRatioSecondary["minimum"] = 1.6;
        turnRatioSecondary["maximum"] = 1.6;
        turnRatioSecondary["nominal"] = 1.6;
        inputsJson["designRequirements"]["turnsRatios"].push_back(turnRatioSecondary);

        OpenMagnetics::InputsWrapper inputs(inputsJson);

        // auto ea = inputs.get_operating_point(0).get_excitations_per_winding()[0];
        // std::cout << "ea.get_current()->get_processed()->get_peak().value(): " << ea.get_current()->get_processed()->get_peak().value() << std::endl;
        // std::cout << "ea.get_current()->get_processed()->get_rms().value(): " << ea.get_current()->get_processed()->get_rms().value() << std::endl;

        auto windingLosses = OpenMagnetics::WindingLosses().calculate_losses(magnetic, inputs.get_operating_point(0), temperature);
        json windingLossesJson;
        to_json(windingLossesJson, windingLosses);
        // std::cout << windingLossesJson << std::endl;

        auto simulator = OpenMagnetics::MagneticSimulator();
        auto operatingPoint = inputs.get_operating_point(0);
        auto coreLosses = simulator.calculate_core_losses(operatingPoint, magnetic);
        auto mas = simulator.simulate(inputs, magnetic);
        json coreLossesJson;
        to_json(coreLossesJson, coreLosses);
        // std::cout << coreLossesJson << std::endl;

        OpenMagnetics::MagneticAdviser::preview_magnetic(mas);

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_1.mas.json");
            OpenMagnetics::to_file(outFile, mas);
        }


        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_1_Waveform_Primary_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_1_Waveform_Primary_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_1_Waveform_Secondaty_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_1_Waveform_Secondaty_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_1.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, true);

            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);
            settings->set_painter_number_points_x(100);
            settings->set_painter_number_points_y(100);
            settings->set_painter_logarithmic_scale(true);
            settings->set_painter_include_fringing(true);

            painter.paint_magnetic_field(inputs.get_operating_point(0), magnetic);
            painter.paint_core(magnetic);
            painter.paint_bobbin(magnetic);
            painter.paint_coil_turns(magnetic);
            painter.export_svg();
            settings->reset();
        }
    }

    TEST(Test_IEEE_Article_Simulation_2) {

        double temperature = 20;
        std::vector<int64_t> numberTurns = {21, 13};
        std::vector<int64_t> numberParallels = {1, 2};
        std::vector<double> turnsRatios = {1.6};
        std::string shapeName = "PQ 60/52";
        uint8_t interleavingLevel = 1;
        auto windingOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto layersOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto turnsAlignment = OpenMagnetics::CoilAlignment::INNER_OR_TOP;
        auto sectionsAlignment = OpenMagnetics::CoilAlignment::CENTERED;

        // settings->set_coil_fill_sections_with_margin_tape(true);

        std::vector<OpenMagnetics::WireWrapper> wires;
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_strand("Round 0.071 - Grade 1");
            int numberStrands = 600;
            wire.set_nominal_value_outer_diameter(OpenMagnetics::WireWrapper::get_outer_diameter_insulated_litz(0.000071, numberStrands, 3, 5.08e-05));
            wire.set_number_conductors(numberStrands);
            wire.set_type(OpenMagnetics::WireType::LITZ);
            OpenMagnetics::InsulationWireCoating coating;
            coating.set_type(OpenMagnetics::InsulationWireCoatingType::INSULATED);
            coating.set_number_layers(3);
            coating.set_material("FEP");
            coating.set_thickness_layers(5.08e-05);
            coating.set_temperature_rating(155);
            coating.set_breakdown_voltage(9000);
            wire.set_coating(coating);
            wires.push_back(wire);
        }

        {
            OpenMagnetics::WireWrapper wire;
            wire.set_strand("Round 0.071 - Grade 1");
            int numberStrands = 500;
            wire.set_nominal_value_outer_diameter(OpenMagnetics::WireWrapper::get_outer_diameter_bare_litz(0.000071, numberStrands));
            wire.set_number_conductors(numberStrands);
            wire.set_type(OpenMagnetics::WireType::LITZ);
            OpenMagnetics::InsulationWireCoating coating;
            coating.set_type(OpenMagnetics::InsulationWireCoatingType::BARE);
            wire.set_coating(coating);
            wires.push_back(wire);
        }
        int64_t numberStacks = 1;
        auto coil = OpenMagneticsTesting::get_quick_coil(numberTurns,
                                                         numberParallels,
                                                         shapeName,
                                                         interleavingLevel,
                                                         windingOrientation,
                                                         layersOrientation,
                                                         turnsAlignment,
                                                         sectionsAlignment,
                                                         wires,
                                                         true,
                                                         numberStacks);

        coil.wind({0, 1}, 2);

        std::string coreMaterial = "3C95F";
        auto gapping = OpenMagneticsTesting::get_ground_gap(0.00001);
        auto core = OpenMagneticsTesting::get_quick_core(shapeName, gapping, numberStacks, coreMaterial);
        OpenMagnetics::Magnetic magnetic;
        magnetic.set_core(core);
        magnetic.set_coil(coil);

        json inputsJson;

        inputsJson["operatingPoints"] = json::array();
        json operatingPointJson = json();
        operatingPointJson["name"] = "Nominal";
        operatingPointJson["conditions"] = json();
        operatingPointJson["conditions"]["ambientTemperature"] = 80;

        operatingPointJson["excitationsPerWinding"] = json::array();
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 100000;
            windingExcitation["current"]["waveform"]["data"] = {0, 17.5, 22.5, -17.5, -22.5, 0};
            windingExcitation["current"]["waveform"]["time"] = {0, 0, 0.000005, 0.000005, 0.00001, 0.00001};
            windingExcitation["voltage"]["waveform"]["data"] = {800, 800, -800, -800, 800};
            windingExcitation["voltage"]["waveform"]["time"] = {0, 0.000005, 0.000005, 0.00001, 0.00001};
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        inputsJson["operatingPoints"].push_back(operatingPointJson);

        inputsJson["designRequirements"] = json();
        inputsJson["designRequirements"]["magnetizingInductance"]["nominal"] = 720e-6;
        inputsJson["designRequirements"]["turnsRatios"] = json::array();
        json turnRatioSecondary;
        turnRatioSecondary["minimum"] = 1.6;
        turnRatioSecondary["maximum"] = 1.6;
        turnRatioSecondary["nominal"] = 1.6;
        inputsJson["designRequirements"]["turnsRatios"].push_back(turnRatioSecondary);

        OpenMagnetics::InputsWrapper inputs(inputsJson);



        auto windingLosses = OpenMagnetics::WindingLosses().calculate_losses(magnetic, inputs.get_operating_point(0), temperature);
        json windingLossesJson;
        to_json(windingLossesJson, windingLosses);
        // std::cout << windingLossesJson << std::endl;

        auto simulator = OpenMagnetics::MagneticSimulator();
        auto operatingPoint = inputs.get_operating_point(0);
        auto coreLosses = simulator.calculate_core_losses(operatingPoint, magnetic);
        auto mas = simulator.simulate(inputs, magnetic);
        json coreLossesJson;
        to_json(coreLossesJson, coreLosses);
        // std::cout << coreLossesJson << std::endl;

        OpenMagnetics::MagneticAdviser::preview_magnetic(mas);

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_2.mas.json");
            OpenMagnetics::to_file(outFile, mas);
        }


        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_2_Waveform_Primary_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_2_Waveform_Primary_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_2_Waveform_Secondaty_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_2_Waveform_Secondaty_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_2.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, true);

            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);
            settings->set_painter_number_points_x(100);
            settings->set_painter_number_points_y(100);
            settings->set_painter_logarithmic_scale(true);
            settings->set_painter_include_fringing(true);

            painter.paint_magnetic_field(inputs.get_operating_point(0), magnetic);
            painter.paint_core(magnetic);
            painter.paint_bobbin(magnetic);
            painter.paint_coil_turns(magnetic);
            painter.export_svg();
            settings->reset();
        }
    }

    TEST(Test_IEEE_Article_Simulation_3) {

        double temperature = 20;
        std::vector<int64_t> numberTurns = {32, 2};
        std::vector<int64_t> numberParallels = {1, 1};
        std::vector<double> turnsRatios = {16};
        std::string shapeName = "ETD 29/16/10";
        uint8_t interleavingLevel = 1;
        auto windingOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto layersOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto turnsAlignment = OpenMagnetics::CoilAlignment::SPREAD;
        auto sectionsAlignment = OpenMagnetics::CoilAlignment::CENTERED;

        std::vector<OpenMagnetics::WireWrapper> wires;
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_strand("Round 0.071 - Grade 1");
            int numberStrands = 110;
            wire.set_nominal_value_outer_diameter(OpenMagnetics::WireWrapper::get_outer_diameter_served_litz(0.000071, numberStrands, 1, 1));
            wire.set_number_conductors(numberStrands);
            wire.set_type(OpenMagnetics::WireType::LITZ);
            OpenMagnetics::InsulationWireCoating coating;
            coating.set_type(OpenMagnetics::InsulationWireCoatingType::SERVED);
            coating.set_number_layers(1);
            wire.set_coating(coating);
            wires.push_back(wire);
        }
        {
            OpenMagnetics::WireWrapper wire;
            wire.set_nominal_value_conducting_width(0.0005);
            wire.set_nominal_value_conducting_height(0.018);
            wire.set_nominal_value_outer_width(0.00053);
            wire.set_nominal_value_outer_height(0.018);
            wire.set_number_conductors(1);
            wire.set_material("copper");
            wire.set_type(OpenMagnetics::WireType::FOIL);
            wires.push_back(wire);
        }

        auto coil = OpenMagneticsTesting::get_quick_coil(numberTurns,
                                                         numberParallels,
                                                         shapeName,
                                                         interleavingLevel,
                                                         windingOrientation,
                                                         layersOrientation,
                                                         turnsAlignment,
                                                         sectionsAlignment,
                                                         wires,
                                                         true);

        coil.wind({0, 1}, 1);

        int64_t numberStacks = 1;
        std::string coreMaterial = "3C95";
        auto gapping = OpenMagneticsTesting::get_ground_gap(0.0004);
        auto core = OpenMagneticsTesting::get_quick_core(shapeName, gapping, numberStacks, coreMaterial);
        OpenMagnetics::Magnetic magnetic;
        magnetic.set_core(core);
        magnetic.set_coil(coil);

        json inputsJson;

        inputsJson["operatingPoints"] = json::array();
        json operatingPointJson = json();
        operatingPointJson["name"] = "Nominal";
        operatingPointJson["conditions"] = json();
        operatingPointJson["conditions"]["ambientTemperature"] = 100;

        operatingPointJson["excitationsPerWinding"] = json::array();
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 115000;
            windingExcitation["current"]["processed"]["label"] = "Sinusoidal";
            windingExcitation["current"]["processed"]["peakToPeak"] = 4 * 2;
            windingExcitation["current"]["processed"]["offset"] = 0;
            windingExcitation["current"]["processed"]["dutyCycle"] = 0.5;
            windingExcitation["voltage"]["processed"]["label"] = "Rectangular";
            windingExcitation["voltage"]["processed"]["peakToPeak"] = 380;
            windingExcitation["voltage"]["processed"]["offset"] = 0;
            windingExcitation["voltage"]["processed"]["dutyCycle"] = 0.5;
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 115000;
            windingExcitation["current"]["processed"]["label"] = "Sinusoidal";
            windingExcitation["current"]["processed"]["peakToPeak"] = 64 * 2;
            windingExcitation["current"]["processed"]["offset"] = 0;
            windingExcitation["current"]["processed"]["dutyCycle"] = 0.5;
            windingExcitation["voltage"]["processed"]["label"] = "Rectangular";
            windingExcitation["voltage"]["processed"]["peakToPeak"] = 24;
            windingExcitation["voltage"]["processed"]["offset"] = 0;
            windingExcitation["voltage"]["processed"]["dutyCycle"] = 0.5;
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        inputsJson["operatingPoints"].push_back(operatingPointJson);

        inputsJson["designRequirements"] = json();
        inputsJson["designRequirements"]["magnetizingInductance"]["nominal"] = 200e-6;
        inputsJson["designRequirements"]["turnsRatios"] = json::array();
        inputsJson["designRequirements"]["turnsRatios"].push_back(16);

        OpenMagnetics::InputsWrapper inputs(inputsJson);



        auto windingLosses = OpenMagnetics::WindingLosses().calculate_losses(magnetic, inputs.get_operating_point(0), temperature);
        json windingLossesJson;
        to_json(windingLossesJson, windingLosses);
        // std::cout << windingLossesJson << std::endl;

        auto simulator = OpenMagnetics::MagneticSimulator();
        auto operatingPoint = inputs.get_operating_point(0);
        auto coreLosses = simulator.calculate_core_losses(operatingPoint, magnetic);
        auto mas = simulator.simulate(inputs, magnetic);
        json coreLossesJson;
        to_json(coreLossesJson, coreLosses);
        // std::cout << coreLossesJson << std::endl;

        OpenMagnetics::MagneticAdviser::preview_magnetic(mas);

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_3.mas.json");
            OpenMagnetics::to_file(outFile, mas);
        }


        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_3_Waveform_Primary_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_3_Waveform_Primary_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_3_Waveform_Secondaty_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_3_Waveform_Secondaty_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_IEEE_Article_Simulation_3.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, true);

            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);
            settings->set_painter_number_points_x(100);
            settings->set_painter_number_points_y(100);
            // settings->set_painter_maximum_value_colorbar(8000);
            // settings->set_painter_minimum_value_colorbar(500);
            settings->set_painter_logarithmic_scale(true);
            settings->set_painter_include_fringing(true);

            painter.paint_magnetic_field(inputs.get_operating_point(0), magnetic);
            painter.paint_core(magnetic);
            painter.paint_bobbin(magnetic);
            painter.paint_coil_turns(magnetic);
            painter.export_svg();
            settings->reset();
        }
    }

    TEST(Test_Flyback_Simulation) {

        double temperature = 20;
        std::vector<int64_t> numberTurns = {80, 8, 6};
        std::vector<int64_t> numberParallels = {1, 2, 6};
        std::vector<double> turnsRatios = {16, 13};
        std::string shapeName = "ER 28";
        uint8_t interleavingLevel = 1;
        auto windingOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto layersOrientation = OpenMagnetics::WindingOrientation::OVERLAPPING;
        auto turnsAlignment = OpenMagnetics::CoilAlignment::SPREAD;
        auto sectionsAlignment = OpenMagnetics::CoilAlignment::CENTERED;

        std::vector<OpenMagnetics::WireWrapper> wires;
        {
            OpenMagnetics::WireWrapper wire = OpenMagnetics::find_wire_by_name("Round 0.25 - FIW 6");
            wires.push_back(wire);
        }
        {
            OpenMagnetics::WireWrapper wire = OpenMagnetics::find_wire_by_name("Round T21A01TXXX-1");
            wires.push_back(wire);
        }
        {
            OpenMagnetics::WireWrapper wire = OpenMagnetics::find_wire_by_name("Round 0.25 - FIW 6");
            wires.push_back(wire);
        }

        auto coil = OpenMagneticsTesting::get_quick_coil(numberTurns,
                                                         numberParallels,
                                                         shapeName,
                                                         interleavingLevel,
                                                         windingOrientation,
                                                         layersOrientation,
                                                         turnsAlignment,
                                                         sectionsAlignment,
                                                         wires,
                                                         true);

        coil.wind({0, 1, 2}, 1);

        int64_t numberStacks = 1;
        std::string coreMaterial = "3C95";
        auto gapping = OpenMagneticsTesting::get_ground_gap(0.0000008);
        auto core = OpenMagneticsTesting::get_quick_core(shapeName, gapping, numberStacks, coreMaterial);
        OpenMagnetics::Magnetic magnetic;
        magnetic.set_core(core);
        magnetic.set_coil(coil);

        json inputsJson;

        inputsJson["operatingPoints"] = json::array();
        json operatingPointJson = json();
        operatingPointJson["name"] = "Nominal";
        operatingPointJson["conditions"] = json();
        operatingPointJson["conditions"]["ambientTemperature"] = 100;

        operatingPointJson["excitationsPerWinding"] = json::array();
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 38000;
            windingExcitation["voltage"]["waveform"]["time"] = {0.0, 3.054077224509666e-10, 9.535015487302436e-10, 1.169532824157234e-9, 1.3855640995842243e-9, 4.696816321468088e-8, 9.319885615605851e-8, 3.410788555624003e-7, 5.070348758027365e-7, 5.956876027992601e-7, 6.870688323048804e-7, 9.126054838506735e-7, 0.0000010532418441536443, 0.0000011444070423838393, 0.000001279858652076569, 0.0000014194148560024064, 0.0000016008811273610902, 0.0000017397892374606484, 0.000001875888940979659, 0.0000019681342955869856, 0.0000020141489572529363, 0.000002151112785873655, 0.0000021966953849887516, 0.000002242710046654702, 0.000002288724708320653, 0.0000023347393699866035, 0.0000027009123818353674, 0.0000027922936113409877, 0.0000028380922417315113, 0.000002884106903397462, 0.0000029299055337879856, 0.0000030670853936841295, 0.000003112884024074653, 0.0000032046973161311275, 0.0000033876758064177968, 0.0000034334744368083204, 0.0000035252877288647947, 0.0000035710863592553183, 0.0000036624675887609386, 0.0000037082662191514623, 0.000003754064849541986, 0.000003845878141598462, 0.000003983058001494606, 0.000004257849783837748, 0.000004303648414228271, 0.000004349447044618795, 0.000004532641566180891, 0.000004578440196571415, 0.000004624238826961939, 0.000004670037457352462, 0.0000048990306093050805, 0.000004944829239695604, 0.0000049906278700861295, 0.000005036426500476653, 0.000005082225130867177, 0.0000051280237612577004, 0.000005173822391648224, 0.000005219621022038748, 0.000005265419652429271, 0.000005311218282819795, 0.000005357016913210319, 0.000005402815543600842, 0.000005448614173991366, 0.00000549441280438189, 0.000005540211434772413, 0.000005586010065162939, 0.0000056318086955534605, 0.000005677607325943986, 0.000005723405956334508, 0.000005769204586725033, 0.000005815003217115555, 0.0000058608018475060805, 0.000005906600477896606, 0.000005952399108287128, 0.000005998197738677653, 0.000006043996369068175, 0.00000622719089063027, 0.000006318788151411317, 0.000006364586781801842, 0.00000645618404258289, 0.000006501982672973415, 0.000006547781303363937, 0.000006593579933754462, 0.000006639594595420413, 0.000006685393225810938, 0.00000673119185620146, 0.000006822573085707079, 0.000006868371716097604, 0.00000696018500815408, 0.000007005983638544602, 0.000007142947467165321, 0.000007233896634120085, 0.000007279479233235185, 0.000007824310109862082, 0.000007869892708977182, 0.000007915475308092275, 0.000008006856537597897, 0.00000819048312171085, 0.000008236497783376797, 0.000008467219185532829, 0.00000865214195729834, 0.000008744387311905666, 0.000008836632666512993, 0.000008882647328178943, 0.000008928661989844894, 0.000009020475281901367, 0.00000915787117307294, 0.000009294835001693654, 0.000009431366767763523, 0.00000947694936687862, 0.00000952231593471829, 0.00000974936480519207, 0.000009794947404307163, 0.000009840313972146837, 0.00000988589657126193, 0.00000993147917037703, 0.000009977061769492127, 0.000010114241629388271, 0.000010160040259778797, 0.000010297652182225791, 0.000010343666843891745, 0.000010389681505557692, 0.000010435696167223646, 0.0000106201868764383, 0.000010712432231045626, 0.000010804677585652956, 0.000010896922940260283, 0.000010942937601926233, 0.000010988952263592184, 0.000011034966925258135, 0.000011126780217314607, 0.000011172578847705132, 0.000011218377478095654, 0.00001126417610848618, 0.000011355557337991802, 0.000011401139937106898, 0.000011446722536221995, 0.000011492305135337092, 0.000011537887734452188, 0.000011583470333567285, 0.000011765368667476821, 0.000011947483032661782, 0.000011993065631776879, 0.000012038648230891979, 0.000012084230830007072, 0.000012175612059512694, 0.00001222141068990322, 0.000012267209320293742, 0.000012313007950684267, 0.000012496634534797216, 0.000012680909212736443, 0.000012726923874402394, 0.000012772938536068345, 0.000012865183890675671, 0.000012911198552341622, 0.000012957213214007576, 0.000013003227875673523, 0.000013095257199005424, 0.000013141271860671375, 0.000013233085152727851, 0.000013278883783118373, 0.000013324682413508898, 0.00001337048104389942, 0.000013416279674289946, 0.000013507660903795564, 0.000013553243502910664, 0.000013644408701140858, 0.000013735573899371051, 0.000013781156498486148, 0.000013826739097601244, 0.000014008853462786206, 0.000014054436061901306, 0.000014100018661016399, 0.000014191399890522021, 0.000014282781120027643, 0.000014465975641589737, 0.000014511774271980263, 0.000014649602225702686, 0.000014695616887368637, 0.000014741631549034587, 0.000014787646210700538, 0.000014833660872366489, 0.00001492569019569839, 0.000014971704857364337, 0.000015017719519030291, 0.000015063734180696238, 0.00001515576350402814, 0.00001520177816569409, 0.000015293591457750565, 0.000015385404749807037, 0.000015431203380197566, 0.000015477002010588088, 0.000015751145699104947, 0.000015796728298220047, 0.000015842310897335147, 0.00001588789349645024, 0.00001593347609556534, 0.000015979058694680434, 0.000016024641293795534, 0.000016070223892910627, 0.000016115806492025727, 0.00001616138909114082, 0.00001620697169025592, 0.000016298352919761542, 0.000016435532779657686, 0.00001648133141004821, 0.000016527130040438737, 0.00001657292867082926, 0.000016710540593276254, 0.000016756555254942204, 0.000016894383208664634, 0.000016986412531996535, 0.000017032427193662486, 0.00001707844185532843, 0.000017124456516994387, 0.00001717047117866033, 0.00001726228447071681, 0.00001730829913238276, 0.000017400112424439234, 0.00001753772434688623, 0.000017583522977276757, 0.0000177207028371729, 0.000017812084066678523, 0.000017857666665793616, 0.00001794904789529924, 0.00001799463049441434, 0.00001804021309352943, 0.00001808579569264453, 0.000018222759521265247, 0.000018268342120380347, 0.00001831392471949544, 0.000018359723349885962, 0.000018405305949001062, 0.000018588284439287728, 0.00001863408306967825, 0.00001867988170006878, 0.00001881749362251578, 0.000018909306914572253, 0.000019047134868294676, 0.000019093149529960627, 0.000019139164191626577, 0.000019276992145349, 0.00001932300680701495, 0.00001941482009907143, 0.000019460834760737374, 0.000019506633391127903, 0.000019552432021518425, 0.000019644245313574898, 0.00001969004394396542, 0.00001973584257435594, 0.000019873022434252092, 0.000019964403663757714, 0.000020009986262872808, 0.00002010136749237843, 0.000020146950091493523, 0.000020283913920114245, 0.000020329496519229338, 0.00002042087774873496, 0.000020512258978240582, 0.000020603640207746204, 0.000020649438838136726, 0.000020695237468527255, 0.000020741036098917777, 0.0000207868347293083, 0.00002083263335969882, 0.000020970245282145822, 0.000021108073235868252, 0.000021337714481647148, 0.00002147554243536957, 0.000021567355727426044, 0.000021659169019482516, 0.000021704967649873038, 0.000021750766280263567, 0.00002179656491065409, 0.00002184236354104461, 0.000021888162171435133, 0.000022025342031331283, 0.000022070924630446377, 0.000022116723260836905, 0.00002220810449034252, 0.00002225368708945762, 0.000022345068318963243, 0.000022482032147583965, 0.00002257341337708958, 0.000022664794606595202, 0.000022710593236985724, 0.000022756391867376246, 0.000022939586388938347, 0.000023021246211049767, - 0.00002302146224232519, - 0.000023021678273600617, - 0.000023021894304876046, 0.000023022110336151468, 0.000023022326367426896, 0.000023022542398702325, 0.000023022758429977754, 0.000023022974461253176, 0.000023023190492528604, 0.000023023406523804033, 0.000023023622555079455, 0.000023023838586354884, 0.000023024054617630312, 0.00002302427064890574, 0.00002306790896654199, 0.00002306812499781742, 0.000023068341029092847, 0.000023068557060368276, 0.000023068773091643698, 0.000023068989122919126, 0.000023069205154194555, 0.000023069421185469977, 0.000023113923628207947, 0.000023114139659483376, 0.000023114355690758804, 0.000023114571722034226, 0.000023159938289873898, 0.000023160154321149326, 0.000023160370352424748, 0.00002320573692026442, 0.00002320595295153985, 0.00002325175158193037, 0.0000232975502123209, 0.00002334334884271142, 0.000023389147473101943, 0.00002343494610349247, 0.000023480744733882994, 0.000023526543364273516, 0.000023572341994664038, 0.000023618140625054566, 0.000023663939255445088, 0.00002370973788583561, 0.000023755536516226132, 0.00002380133514661666, 0.000023847133777007183, 0.000023892932407397705, 0.000023938731037788227, 0.000023984529668178755, 0.000024030328298569277, 0.00002416772418974085, 0.000024305120080912423, 0.000024396717341693467, 0.00002444251597208399, 0.000024488314602474517, 0.00002453411323286504, 0.00002457991186325556, 0.00002462571049364609, 0.000024671509124036612, 0.000024717307754427134, 0.000024763106384817656, 0.000024808905015208184, 0.000024854703645598706, 0.00002490050227598923, 0.00002494630090637975, 0.00002499209953677028, 0.0000250378981671608, 0.000025083696797551323, 0.000025129495427941845, 0.000025175294058332374, 0.000025221092688722896, 0.000025266891319113418, 0.000025312689949503946, 0.000025358488579894468, 0.00002540428721028499, 0.000025450085840675512, 0.00002549588447106604, 0.000026316};
            windingExcitation["voltage"]["waveform"]["data"] = {836.9398584905659, 975.8942610062891, 1017.5805817610062, 1031.4760220125784, 1045.3714622641508, 1031.4760220125784, 1059.2669025157231, 938.6792452830186, 613.2075471698113, 975.8942610062891, 961.9988207547169, 739.6717767295597, 948.1033805031445, 920.3124999999998, 795.253537735849, 934.2079402515722, 823.0444182389936, 920.3124999999998, 836.9398584905659, 878.6261792452829, 892.5216194968552, 864.7307389937107, 850.8352987421383, 864.7307389937107, 878.6261792452829, 892.5216194968552, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 864.7307389937107, 878.6261792452829, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 850.8352987421383, 809.1489779874214, 795.253537735849, 489.553852201258, 475.6584119496856, 461.76297169811323, 447.8675314465411, 475.6584119496856, 489.553852201258, 600.7173742138366, 711.880896226415, 753.5672169811321, 795.253537735849, 809.1489779874214, 823.0444182389936, 836.9398584905659, 836.9398584905659, 809.1489779874214, 753.5672169811321, 739.6717767295597, 711.880896226415, 586.8219339622642, 572.9264937106918, 545.1356132075473, 531.2401729559749, 517.3447327044025, 503.44929245283015, 489.553852201258, 489.553852201258, 503.44929245283015, 517.3447327044025, 531.2401729559749, 545.1356132075473, 628.5082547169811, 670.194575471698, 711.880896226415, 753.5672169811321, 767.4626572327043, 781.3580974842766, 795.253537735849, 809.1489779874214, 809.1489779874214, 809.1489779874214, 809.1489779874214, 795.253537735849, 781.3580974842766, 767.4626572327043, 753.5672169811321, 739.6717767295597, 725.7763364779873, 642.4036949685535, 572.9264937106918, 559.0310534591194, 545.1356132075473, 531.2401729559749, 517.3447327044025, 517.3447327044025, 517.3447327044025, 517.3447327044025, 545.1356132075473, 614.6128144654087, 628.5082547169811, 642.4036949685535, 684.0900157232704, 697.9854559748428, 711.880896226415, 725.7763364779873, 753.5672169811321, 767.4626572327043, 781.3580974842766, 781.3580974842766, 781.3580974842766, 781.3580974842766, 781.3580974842766, 767.4626572327043, 753.5672169811321, 725.7763364779873, 697.9854559748428, 684.0900157232704, 670.194575471698, 600.7173742138366, 586.8219339622642, 572.9264937106918, 559.0310534591194, 545.1356132075473, 545.1356132075473, 545.1356132075471, 572.9264937106916, 586.821933962264, 600.7173742138364, 614.6128144654085, 628.5082547169809, 656.2991352201257, 670.1945754716978, 684.0900157232702, 697.9854559748426, 725.7763364779871, 739.6717767295595, 753.5672169811319, 767.462657232704, 767.462657232704, 767.462657232704, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 642.4036949685533, 628.5082547169809, 614.6128144654085, 600.7173742138364, 586.821933962264, 572.9264937106916, 559.0310534591192, 559.0310534591192, 559.0310534591192, 559.0310534591192, 572.9264937106916, 586.821933962264, 614.6128144654085, 642.4036949685533, 656.2991352201257, 670.1945754716978, 684.0900157232702, 697.9854559748426, 711.8808962264147, 725.7763364779871, 739.6717767295595, 753.5672169811319, 753.5672169811319, 739.6717767295595, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 628.5082547169809, 614.6128144654085, 600.7173742138364, 600.7173742138364, 586.821933962264, 572.9264937106916, 572.9264937106916, 572.9264937106916, 586.821933962264, 600.7173742138364, 628.5082547169809, 642.4036949685533, 656.2991352201257, 684.0900157232702, 697.9854559748426, 711.8808962264147, 725.7763364779871, 725.7763364779871, 725.7763364779871, 739.6717767295595, 739.6717767295595, 739.6717767295595, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 642.4036949685533, 628.5082547169809, 614.6128144654085, 600.7173742138364, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 600.7173742138364, 628.5082547169809, 670.1945754716978, 697.9854559748426, 711.8808962264147, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 711.8808962264147, 697.9854559748426, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 628.5082547169809, 614.6128144654085, 600.7173742138364, 600.7173742138364, 600.7173742138364, 600.7173742138364, 38.47287735849068, 24.577437106918296, 10.681996855345915, 3.2134433962264666, 17.108883647798848, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 86.5860849056603, 100.48152515723268, 114.37696540880506, 128.27240566037744, 142.16784591194983, 156.0632861635222, 17.108883647798848, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 86.5860849056603, 100.48152515723268, 114.37696540880506, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 44.89976415094361, 58.79520440251554, 72.69064465408792, 44.89976415094361, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554};
            
            // windingExcitation["current"]["waveform"]["data"] = {-0.01, 0.01, -0.01};
            // windingExcitation["current"]["waveform"]["time"] = {0, 0.000026316 / 2, 0.000026316};
            // windingExcitation["current"]["waveform"]["ancillaryLabel"] = "Triangular";
            windingExcitation["current"]["waveform"]["time"] = {-6.066537109010479e-8, -1.4866740699589611e-8, -1.4866740699587917e-8, -1.4866740699587917e-8, -1.4866740699587917e-8, -1.4866740699587917e-8, -1.4866740699587917e-8, -1.4866740699587917e-8, -1.4866740699586223e-8, -1.4866740699586223e-8, -1.4866740699586223e-8, -1.4866740699586223e-8, -1.4866740699586223e-8, -1.4866740699584529e-8, -1.4866740699582835e-8, -1.486674069958114e-8, -1.486674069958114e-8, 3.093188969094081e-8, 3.093188969094081e-8, 3.093188969094081e-8, 3.0931889690942506e-8, 3.0931889690942506e-8, 1.6832778086252022e-7, 1.6832778086252022e-7, 1.6832778086252022e-7, 1.6832778086252022e-7, 2.1412641125304387e-7, 2.599250416435675e-7, 4.0421987784568223e-7, 5.347168239867077e-7, 6.218767351471702e-7, 7.151582454192478e-7, 9.328151027207477e-7, 9.927031278919459e-7, 0.000001212659633536962, 0.0000014303164908384584, 0.000001523598001110531, 0.000001710161021654671, 0.0000018345363686841017, 0.000001927817878956171, 0.000002114380899500316, 0.0000024875069405885978, 0.0000036068850638534516, 0.00002293024708495284, 0.000022976045715343368, 0.000022976045715343368, 0.000022976045715343368, 0.000022976045715343368, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.00002302184434573389, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.000023021844345733896, 0.00002302498611882292, 0.00002306764297612441, 0.00002306764297612441, 0.00002306764297612441, 0.00002306764297612441, 0.00002306764297612441, 0.00002306764297612441, 0.00002306764297612441, 0.00002306764297612441, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.000023067642976124418, 0.00002307162687395894, 0.000023113441606514933, 0.000023113441606514933, 0.000023113441606514933, 0.000023113441606514933, 0.000023113441606514933, 0.000023159240236905462, 0.000023159240236905462, 0.000023159240236905462, 0.000023159240236905462, 0.000023159240236905462, 0.000023159240236905462, 0.000023159240236905462, 0.000023205038867295984, 0.000023205038867295984, 0.000023205038867295984, 0.000023205038867295984, 0.000023205038867295984, 0.000023250837497686506, 0.000023250837497686506, 0.000023250837497686506, 0.000023296636128077028, 0.000023296636128077028, 0.000023342434758467557, 0.00002338823338885808, 0.00002338823338885808, 0.0000234340320192486, 0.000023479830649639123, 0.000023708823801591746, 0.000025559133814547507, 0.000025590227651304868, 0.000025632366277993736, 0.000025632366277993736, 0.000026316};
            windingExcitation["current"]["waveform"]["data"] = {1.5512400793651047, 3.1644345238095433, 3.0942956349206554, 3.0241567460317675, 2.9540178571428797, 2.883878968253992, 2.8137400793651004, 2.7436011904762125, 2.6734623015873247, 2.603323412698437, 2.5331845238095454, 2.4630456349206575, 2.3929067460317697, 2.322767857142882, 1.7616567460317718, 1.4811011904762168, 1.410962301587329, 1.7616567460317718, 1.691517857142884, 1.6213789682539925, 1.5512400793651047, 1.4811011904762168, 0.008184523809553923, -0.06195436507933394, -0.1320932539682218, -0.20223214285710966, -0.1320932539682218, -0.1320932539682218, -1.047619047619012, 0.49915674603177607, 1.2857142857143131, -0.14285714285711038, -0.23809523809520527, 0.49915674603177607, -0.4285714285713951, 0.3809523809524116, -0.23809523809520527, 0.19047619047622177, -0.14285714285711038, 0.19047619047622177, -0.047619047619015475, 0.14285714285717077, .197442310920451e-14, 0.00818452380955037, 0.4991567460317725, 0.14846230158732965, 0.07832341269843823, 0.00818452380955037, 0.4991567460317725, 0.42901785714288465, 0.35887896825399324, 0.2887400793651054, 0.2186011904762175, 0.14846230158732965, 0.07832341269843823, 0.00818452380955037, -0.06195436507933749, -0.13209325396822535, -0.20223214285711322, -0.27237103174600463, -0.3425099206348925, -0.41264880952378036, -0.4827876984126682, -0.5529265873015596, -0.6230654761904475, -0.6932043650793354, -0.7633432539682232, -0.8334821428571111, -0.9036210317460025, -0.9737599206348904, -1.0438988095237782, -1.114037698412666, -1.1841765873015575, -1.2543154761904454, -1.3244543650793332, -1.394593253968221, -1.4647321428571125, -3.1428571428571033, 0.42901785714288465, 0.35887896825399324, 0.2887400793651054, 0.2186011904762175, 0.07832341269843823, 0.00818452380955037, -0.06195436507933749, -0.13209325396822535, -0.20223214285711322, -0.27237103174600463, -0.3425099206348925, -0.41264880952378036, -0.4827876984126682, -0.5529265873015596, -0.6230654761904475, -0.6932043650793354, -0.7633432539682232, -0.8334821428571111, -0.9036210317460025, -0.9737599206348904, -1.0438988095237782, -1.114037698412666, -1.1841765873015575, -1.2543154761904454, -1.3244543650793332, 1.809523809523828, 0.4991567460317725, 0.42901785714288465, 0.07832341269843823, 0.00818452380955037, -0.06195436507933749, 0.4991567460317725, 0.42901785714288465, 0.35887896825399324, 0.2887400793651054, 0.2186011904762175, 0.07832341269843823, 0.00818452380955037, 0.4991567460317725, 0.14846230158732965, 0.07832341269843823, 0.00818452380955037, -0.06195436507933749, 0.07832341269843823, 0.00818452380955037, -0.06195436507933749, 0.00818452380955037, -0.06195436507933749, 0.00818452380955037, 0.2186011904762175, 0.14846230158732965, 0.35887896825399324, 0.2887400793651054, 0.42901785714288465, 1.6190476190476417, 1.2380952380952621, 2.813740079365097, 2.743601190476209, 2.673462301587321};
            windingExcitation["current"]["waveform"]["ancillaryLabel"] = "Flyback Primary";
            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 38000;
            windingExcitation["voltage"]["waveform"]["time"] = {0.0, 3.054077224509666e-10, 9.535015487302436e-10, 1.169532824157234e-9, 1.3855640995842243e-9, 4.696816321468088e-8, 9.319885615605851e-8, 3.410788555624003e-7, 5.070348758027365e-7, 5.956876027992601e-7, 6.870688323048804e-7, 9.126054838506735e-7, 0.0000010532418441536443, 0.0000011444070423838393, 0.000001279858652076569, 0.0000014194148560024064, 0.0000016008811273610902, 0.0000017397892374606484, 0.000001875888940979659, 0.0000019681342955869856, 0.0000020141489572529363, 0.000002151112785873655, 0.0000021966953849887516, 0.000002242710046654702, 0.000002288724708320653, 0.0000023347393699866035, 0.0000027009123818353674, 0.0000027922936113409877, 0.0000028380922417315113, 0.000002884106903397462, 0.0000029299055337879856, 0.0000030670853936841295, 0.000003112884024074653, 0.0000032046973161311275, 0.0000033876758064177968, 0.0000034334744368083204, 0.0000035252877288647947, 0.0000035710863592553183, 0.0000036624675887609386, 0.0000037082662191514623, 0.000003754064849541986, 0.000003845878141598462, 0.000003983058001494606, 0.000004257849783837748, 0.000004303648414228271, 0.000004349447044618795, 0.000004532641566180891, 0.000004578440196571415, 0.000004624238826961939, 0.000004670037457352462, 0.0000048990306093050805, 0.000004944829239695604, 0.0000049906278700861295, 0.000005036426500476653, 0.000005082225130867177, 0.0000051280237612577004, 0.000005173822391648224, 0.000005219621022038748, 0.000005265419652429271, 0.000005311218282819795, 0.000005357016913210319, 0.000005402815543600842, 0.000005448614173991366, 0.00000549441280438189, 0.000005540211434772413, 0.000005586010065162939, 0.0000056318086955534605, 0.000005677607325943986, 0.000005723405956334508, 0.000005769204586725033, 0.000005815003217115555, 0.0000058608018475060805, 0.000005906600477896606, 0.000005952399108287128, 0.000005998197738677653, 0.000006043996369068175, 0.00000622719089063027, 0.000006318788151411317, 0.000006364586781801842, 0.00000645618404258289, 0.000006501982672973415, 0.000006547781303363937, 0.000006593579933754462, 0.000006639594595420413, 0.000006685393225810938, 0.00000673119185620146, 0.000006822573085707079, 0.000006868371716097604, 0.00000696018500815408, 0.000007005983638544602, 0.000007142947467165321, 0.000007233896634120085, 0.000007279479233235185, 0.000007824310109862082, 0.000007869892708977182, 0.000007915475308092275, 0.000008006856537597897, 0.00000819048312171085, 0.000008236497783376797, 0.000008467219185532829, 0.00000865214195729834, 0.000008744387311905666, 0.000008836632666512993, 0.000008882647328178943, 0.000008928661989844894, 0.000009020475281901367, 0.00000915787117307294, 0.000009294835001693654, 0.000009431366767763523, 0.00000947694936687862, 0.00000952231593471829, 0.00000974936480519207, 0.000009794947404307163, 0.000009840313972146837, 0.00000988589657126193, 0.00000993147917037703, 0.000009977061769492127, 0.000010114241629388271, 0.000010160040259778797, 0.000010297652182225791, 0.000010343666843891745, 0.000010389681505557692, 0.000010435696167223646, 0.0000106201868764383, 0.000010712432231045626, 0.000010804677585652956, 0.000010896922940260283, 0.000010942937601926233, 0.000010988952263592184, 0.000011034966925258135, 0.000011126780217314607, 0.000011172578847705132, 0.000011218377478095654, 0.00001126417610848618, 0.000011355557337991802, 0.000011401139937106898, 0.000011446722536221995, 0.000011492305135337092, 0.000011537887734452188, 0.000011583470333567285, 0.000011765368667476821, 0.000011947483032661782, 0.000011993065631776879, 0.000012038648230891979, 0.000012084230830007072, 0.000012175612059512694, 0.00001222141068990322, 0.000012267209320293742, 0.000012313007950684267, 0.000012496634534797216, 0.000012680909212736443, 0.000012726923874402394, 0.000012772938536068345, 0.000012865183890675671, 0.000012911198552341622, 0.000012957213214007576, 0.000013003227875673523, 0.000013095257199005424, 0.000013141271860671375, 0.000013233085152727851, 0.000013278883783118373, 0.000013324682413508898, 0.00001337048104389942, 0.000013416279674289946, 0.000013507660903795564, 0.000013553243502910664, 0.000013644408701140858, 0.000013735573899371051, 0.000013781156498486148, 0.000013826739097601244, 0.000014008853462786206, 0.000014054436061901306, 0.000014100018661016399, 0.000014191399890522021, 0.000014282781120027643, 0.000014465975641589737, 0.000014511774271980263, 0.000014649602225702686, 0.000014695616887368637, 0.000014741631549034587, 0.000014787646210700538, 0.000014833660872366489, 0.00001492569019569839, 0.000014971704857364337, 0.000015017719519030291, 0.000015063734180696238, 0.00001515576350402814, 0.00001520177816569409, 0.000015293591457750565, 0.000015385404749807037, 0.000015431203380197566, 0.000015477002010588088, 0.000015751145699104947, 0.000015796728298220047, 0.000015842310897335147, 0.00001588789349645024, 0.00001593347609556534, 0.000015979058694680434, 0.000016024641293795534, 0.000016070223892910627, 0.000016115806492025727, 0.00001616138909114082, 0.00001620697169025592, 0.000016298352919761542, 0.000016435532779657686, 0.00001648133141004821, 0.000016527130040438737, 0.00001657292867082926, 0.000016710540593276254, 0.000016756555254942204, 0.000016894383208664634, 0.000016986412531996535, 0.000017032427193662486, 0.00001707844185532843, 0.000017124456516994387, 0.00001717047117866033, 0.00001726228447071681, 0.00001730829913238276, 0.000017400112424439234, 0.00001753772434688623, 0.000017583522977276757, 0.0000177207028371729, 0.000017812084066678523, 0.000017857666665793616, 0.00001794904789529924, 0.00001799463049441434, 0.00001804021309352943, 0.00001808579569264453, 0.000018222759521265247, 0.000018268342120380347, 0.00001831392471949544, 0.000018359723349885962, 0.000018405305949001062, 0.000018588284439287728, 0.00001863408306967825, 0.00001867988170006878, 0.00001881749362251578, 0.000018909306914572253, 0.000019047134868294676, 0.000019093149529960627, 0.000019139164191626577, 0.000019276992145349, 0.00001932300680701495, 0.00001941482009907143, 0.000019460834760737374, 0.000019506633391127903, 0.000019552432021518425, 0.000019644245313574898, 0.00001969004394396542, 0.00001973584257435594, 0.000019873022434252092, 0.000019964403663757714, 0.000020009986262872808, 0.00002010136749237843, 0.000020146950091493523, 0.000020283913920114245, 0.000020329496519229338, 0.00002042087774873496, 0.000020512258978240582, 0.000020603640207746204, 0.000020649438838136726, 0.000020695237468527255, 0.000020741036098917777, 0.0000207868347293083, 0.00002083263335969882, 0.000020970245282145822, 0.000021108073235868252, 0.000021337714481647148, 0.00002147554243536957, 0.000021567355727426044, 0.000021659169019482516, 0.000021704967649873038, 0.000021750766280263567, 0.00002179656491065409, 0.00002184236354104461, 0.000021888162171435133, 0.000022025342031331283, 0.000022070924630446377, 0.000022116723260836905, 0.00002220810449034252, 0.00002225368708945762, 0.000022345068318963243, 0.000022482032147583965, 0.00002257341337708958, 0.000022664794606595202, 0.000022710593236985724, 0.000022756391867376246, 0.000022939586388938347, 0.000023021246211049767, - 0.00002302146224232519, - 0.000023021678273600617, - 0.000023021894304876046, 0.000023022110336151468, 0.000023022326367426896, 0.000023022542398702325, 0.000023022758429977754, 0.000023022974461253176, 0.000023023190492528604, 0.000023023406523804033, 0.000023023622555079455, 0.000023023838586354884, 0.000023024054617630312, 0.00002302427064890574, 0.00002306790896654199, 0.00002306812499781742, 0.000023068341029092847, 0.000023068557060368276, 0.000023068773091643698, 0.000023068989122919126, 0.000023069205154194555, 0.000023069421185469977, 0.000023113923628207947, 0.000023114139659483376, 0.000023114355690758804, 0.000023114571722034226, 0.000023159938289873898, 0.000023160154321149326, 0.000023160370352424748, 0.00002320573692026442, 0.00002320595295153985, 0.00002325175158193037, 0.0000232975502123209, 0.00002334334884271142, 0.000023389147473101943, 0.00002343494610349247, 0.000023480744733882994, 0.000023526543364273516, 0.000023572341994664038, 0.000023618140625054566, 0.000023663939255445088, 0.00002370973788583561, 0.000023755536516226132, 0.00002380133514661666, 0.000023847133777007183, 0.000023892932407397705, 0.000023938731037788227, 0.000023984529668178755, 0.000024030328298569277, 0.00002416772418974085, 0.000024305120080912423, 0.000024396717341693467, 0.00002444251597208399, 0.000024488314602474517, 0.00002453411323286504, 0.00002457991186325556, 0.00002462571049364609, 0.000024671509124036612, 0.000024717307754427134, 0.000024763106384817656, 0.000024808905015208184, 0.000024854703645598706, 0.00002490050227598923, 0.00002494630090637975, 0.00002499209953677028, 0.0000250378981671608, 0.000025083696797551323, 0.000025129495427941845, 0.000025175294058332374, 0.000025221092688722896, 0.000025266891319113418, 0.000025312689949503946, 0.000025358488579894468, 0.00002540428721028499, 0.000025450085840675512, 0.00002549588447106604, 0.000026316};
            windingExcitation["voltage"]["waveform"]["data"] = {836.9398584905659, 975.8942610062891, 1017.5805817610062, 1031.4760220125784, 1045.3714622641508, 1031.4760220125784, 1059.2669025157231, 938.6792452830186, 613.2075471698113, 975.8942610062891, 961.9988207547169, 739.6717767295597, 948.1033805031445, 920.3124999999998, 795.253537735849, 934.2079402515722, 823.0444182389936, 920.3124999999998, 836.9398584905659, 878.6261792452829, 892.5216194968552, 864.7307389937107, 850.8352987421383, 864.7307389937107, 878.6261792452829, 892.5216194968552, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 864.7307389937107, 878.6261792452829, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 850.8352987421383, 809.1489779874214, 795.253537735849, 489.553852201258, 475.6584119496856, 461.76297169811323, 447.8675314465411, 475.6584119496856, 489.553852201258, 600.7173742138366, 711.880896226415, 753.5672169811321, 795.253537735849, 809.1489779874214, 823.0444182389936, 836.9398584905659, 836.9398584905659, 809.1489779874214, 753.5672169811321, 739.6717767295597, 711.880896226415, 586.8219339622642, 572.9264937106918, 545.1356132075473, 531.2401729559749, 517.3447327044025, 503.44929245283015, 489.553852201258, 489.553852201258, 503.44929245283015, 517.3447327044025, 531.2401729559749, 545.1356132075473, 628.5082547169811, 670.194575471698, 711.880896226415, 753.5672169811321, 767.4626572327043, 781.3580974842766, 795.253537735849, 809.1489779874214, 809.1489779874214, 809.1489779874214, 809.1489779874214, 795.253537735849, 781.3580974842766, 767.4626572327043, 753.5672169811321, 739.6717767295597, 725.7763364779873, 642.4036949685535, 572.9264937106918, 559.0310534591194, 545.1356132075473, 531.2401729559749, 517.3447327044025, 517.3447327044025, 517.3447327044025, 517.3447327044025, 545.1356132075473, 614.6128144654087, 628.5082547169811, 642.4036949685535, 684.0900157232704, 697.9854559748428, 711.880896226415, 725.7763364779873, 753.5672169811321, 767.4626572327043, 781.3580974842766, 781.3580974842766, 781.3580974842766, 781.3580974842766, 781.3580974842766, 767.4626572327043, 753.5672169811321, 725.7763364779873, 697.9854559748428, 684.0900157232704, 670.194575471698, 600.7173742138366, 586.8219339622642, 572.9264937106918, 559.0310534591194, 545.1356132075473, 545.1356132075473, 545.1356132075471, 572.9264937106916, 586.821933962264, 600.7173742138364, 614.6128144654085, 628.5082547169809, 656.2991352201257, 670.1945754716978, 684.0900157232702, 697.9854559748426, 725.7763364779871, 739.6717767295595, 753.5672169811319, 767.462657232704, 767.462657232704, 767.462657232704, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 642.4036949685533, 628.5082547169809, 614.6128144654085, 600.7173742138364, 586.821933962264, 572.9264937106916, 559.0310534591192, 559.0310534591192, 559.0310534591192, 559.0310534591192, 572.9264937106916, 586.821933962264, 614.6128144654085, 642.4036949685533, 656.2991352201257, 670.1945754716978, 684.0900157232702, 697.9854559748426, 711.8808962264147, 725.7763364779871, 739.6717767295595, 753.5672169811319, 753.5672169811319, 739.6717767295595, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 628.5082547169809, 614.6128144654085, 600.7173742138364, 600.7173742138364, 586.821933962264, 572.9264937106916, 572.9264937106916, 572.9264937106916, 586.821933962264, 600.7173742138364, 628.5082547169809, 642.4036949685533, 656.2991352201257, 684.0900157232702, 697.9854559748426, 711.8808962264147, 725.7763364779871, 725.7763364779871, 725.7763364779871, 739.6717767295595, 739.6717767295595, 739.6717767295595, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 642.4036949685533, 628.5082547169809, 614.6128144654085, 600.7173742138364, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 600.7173742138364, 628.5082547169809, 670.1945754716978, 697.9854559748426, 711.8808962264147, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 711.8808962264147, 697.9854559748426, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 628.5082547169809, 614.6128144654085, 600.7173742138364, 600.7173742138364, 600.7173742138364, 600.7173742138364, 38.47287735849068, 24.577437106918296, 10.681996855345915, 3.2134433962264666, 17.108883647798848, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 86.5860849056603, 100.48152515723268, 114.37696540880506, 128.27240566037744, 142.16784591194983, 156.0632861635222, 17.108883647798848, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 86.5860849056603, 100.48152515723268, 114.37696540880506, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 44.89976415094361, 58.79520440251554, 72.69064465408792, 44.89976415094361, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554};

            windingExcitation["current"]["waveform"]["data"] = {-0.01, 0.01, -0.01};
            windingExcitation["current"]["waveform"]["time"] = {0, 0.000026316 / 2, 0.000026316};
            windingExcitation["current"]["waveform"]["ancillaryLabel"] = "Triangular";
            // windingExcitation["current"]["waveform"]["time"] = {0.0, 2.4875069405902054e-7, 4.0421987784581436e-7, 5.907828983899358e-7, 8.553072367205054e-7, 0.0000010385017582825898, 0.000001212659633537084, 0.0000013590921710162553, 0.000001523598001110653, 0.0000017101610216547896, 0.0000018034425319268656, 0.000001958911715713646, 0.0000021376688876551624, 0.0000023009439200445712, 0.0000024875069405887164, 0.000002916245604294061, 0.0000047023921895244815, 0.000005022982602258149, 0.00000593895521006862, 0.00000616794836202124, 0.000006305344253192806, 0.000008732671663890568, 0.000008778470294281093, 0.000012488159355913517, 0.000022976045715343462, 0.000023021844345733984, 0.000023021844345733984, 0.000023021844345733984, 0.000023021844345733984, 0.000023021844345733984, 0.000023021844345733984, 0.000023021844345733984, 0.000023067642976124513, 0.000023113441606515035, 0.000023113441606515035, 0.000023113441606515035, 0.000023113441606515035, 0.000023159240236905557, 0.000023159240236905557, 0.000023159240236905557, 0.00002320503886729608, 0.00002329663612807713, 0.00002334243475846765, 0.000023434032019248702, 0.000023846219692763413, 0.000026316};
            // windingExcitation["current"]["waveform"]["data"] = {-2.8671874999996305, -19.722222222221973, -25.277777777777573, -10.83333333333303, -18.823784722221973, -12.686631944444144, -16.3888888888886, -12.686631944444144, -15.277777777777487, -12.777777777777459, -14.166666666666373, -12.222222222221916, -13.09577546296265, -11.666666666666345, -11.944444444444144, -10.231770833333002, -5.731192129629278, -4.91290509259224, -2.4580439814810973, -2.0489004629625924, -1.6397569444440592, -0.003182870369982993, -0.003182870369982993, -0.003182870369982993, 0.40596064814855026, 2.0425347222226264, 1.6333912037041216, 1.2242476851855884, 0.8151041666670835, 0.40596064814855026, -0.003182870369982993, -0.4123263888884878, -1.6397569444440592, 1.2242476851855884, 0.8151041666670835, 0.40596064814855026, -0.4123263888884878, 1.2242476851855884, 0.8151041666670835, 0.40596064814855026, -0.003182870369982993, -0.003182870369982993, -0.003182870369982993, 0.40596064814855026, -0.003182870369982993, 0.27777777777814094};
            // windingExcitation["current"]["waveform"]["ancillaryLabel"] = "Flyback Secondary";

            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        {
            json windingExcitation = json();
            windingExcitation["frequency"] = 38000;
            windingExcitation["voltage"]["waveform"]["time"] = {0.0, 3.054077224509666e-10, 9.535015487302436e-10, 1.169532824157234e-9, 1.3855640995842243e-9, 4.696816321468088e-8, 9.319885615605851e-8, 3.410788555624003e-7, 5.070348758027365e-7, 5.956876027992601e-7, 6.870688323048804e-7, 9.126054838506735e-7, 0.0000010532418441536443, 0.0000011444070423838393, 0.000001279858652076569, 0.0000014194148560024064, 0.0000016008811273610902, 0.0000017397892374606484, 0.000001875888940979659, 0.0000019681342955869856, 0.0000020141489572529363, 0.000002151112785873655, 0.0000021966953849887516, 0.000002242710046654702, 0.000002288724708320653, 0.0000023347393699866035, 0.0000027009123818353674, 0.0000027922936113409877, 0.0000028380922417315113, 0.000002884106903397462, 0.0000029299055337879856, 0.0000030670853936841295, 0.000003112884024074653, 0.0000032046973161311275, 0.0000033876758064177968, 0.0000034334744368083204, 0.0000035252877288647947, 0.0000035710863592553183, 0.0000036624675887609386, 0.0000037082662191514623, 0.000003754064849541986, 0.000003845878141598462, 0.000003983058001494606, 0.000004257849783837748, 0.000004303648414228271, 0.000004349447044618795, 0.000004532641566180891, 0.000004578440196571415, 0.000004624238826961939, 0.000004670037457352462, 0.0000048990306093050805, 0.000004944829239695604, 0.0000049906278700861295, 0.000005036426500476653, 0.000005082225130867177, 0.0000051280237612577004, 0.000005173822391648224, 0.000005219621022038748, 0.000005265419652429271, 0.000005311218282819795, 0.000005357016913210319, 0.000005402815543600842, 0.000005448614173991366, 0.00000549441280438189, 0.000005540211434772413, 0.000005586010065162939, 0.0000056318086955534605, 0.000005677607325943986, 0.000005723405956334508, 0.000005769204586725033, 0.000005815003217115555, 0.0000058608018475060805, 0.000005906600477896606, 0.000005952399108287128, 0.000005998197738677653, 0.000006043996369068175, 0.00000622719089063027, 0.000006318788151411317, 0.000006364586781801842, 0.00000645618404258289, 0.000006501982672973415, 0.000006547781303363937, 0.000006593579933754462, 0.000006639594595420413, 0.000006685393225810938, 0.00000673119185620146, 0.000006822573085707079, 0.000006868371716097604, 0.00000696018500815408, 0.000007005983638544602, 0.000007142947467165321, 0.000007233896634120085, 0.000007279479233235185, 0.000007824310109862082, 0.000007869892708977182, 0.000007915475308092275, 0.000008006856537597897, 0.00000819048312171085, 0.000008236497783376797, 0.000008467219185532829, 0.00000865214195729834, 0.000008744387311905666, 0.000008836632666512993, 0.000008882647328178943, 0.000008928661989844894, 0.000009020475281901367, 0.00000915787117307294, 0.000009294835001693654, 0.000009431366767763523, 0.00000947694936687862, 0.00000952231593471829, 0.00000974936480519207, 0.000009794947404307163, 0.000009840313972146837, 0.00000988589657126193, 0.00000993147917037703, 0.000009977061769492127, 0.000010114241629388271, 0.000010160040259778797, 0.000010297652182225791, 0.000010343666843891745, 0.000010389681505557692, 0.000010435696167223646, 0.0000106201868764383, 0.000010712432231045626, 0.000010804677585652956, 0.000010896922940260283, 0.000010942937601926233, 0.000010988952263592184, 0.000011034966925258135, 0.000011126780217314607, 0.000011172578847705132, 0.000011218377478095654, 0.00001126417610848618, 0.000011355557337991802, 0.000011401139937106898, 0.000011446722536221995, 0.000011492305135337092, 0.000011537887734452188, 0.000011583470333567285, 0.000011765368667476821, 0.000011947483032661782, 0.000011993065631776879, 0.000012038648230891979, 0.000012084230830007072, 0.000012175612059512694, 0.00001222141068990322, 0.000012267209320293742, 0.000012313007950684267, 0.000012496634534797216, 0.000012680909212736443, 0.000012726923874402394, 0.000012772938536068345, 0.000012865183890675671, 0.000012911198552341622, 0.000012957213214007576, 0.000013003227875673523, 0.000013095257199005424, 0.000013141271860671375, 0.000013233085152727851, 0.000013278883783118373, 0.000013324682413508898, 0.00001337048104389942, 0.000013416279674289946, 0.000013507660903795564, 0.000013553243502910664, 0.000013644408701140858, 0.000013735573899371051, 0.000013781156498486148, 0.000013826739097601244, 0.000014008853462786206, 0.000014054436061901306, 0.000014100018661016399, 0.000014191399890522021, 0.000014282781120027643, 0.000014465975641589737, 0.000014511774271980263, 0.000014649602225702686, 0.000014695616887368637, 0.000014741631549034587, 0.000014787646210700538, 0.000014833660872366489, 0.00001492569019569839, 0.000014971704857364337, 0.000015017719519030291, 0.000015063734180696238, 0.00001515576350402814, 0.00001520177816569409, 0.000015293591457750565, 0.000015385404749807037, 0.000015431203380197566, 0.000015477002010588088, 0.000015751145699104947, 0.000015796728298220047, 0.000015842310897335147, 0.00001588789349645024, 0.00001593347609556534, 0.000015979058694680434, 0.000016024641293795534, 0.000016070223892910627, 0.000016115806492025727, 0.00001616138909114082, 0.00001620697169025592, 0.000016298352919761542, 0.000016435532779657686, 0.00001648133141004821, 0.000016527130040438737, 0.00001657292867082926, 0.000016710540593276254, 0.000016756555254942204, 0.000016894383208664634, 0.000016986412531996535, 0.000017032427193662486, 0.00001707844185532843, 0.000017124456516994387, 0.00001717047117866033, 0.00001726228447071681, 0.00001730829913238276, 0.000017400112424439234, 0.00001753772434688623, 0.000017583522977276757, 0.0000177207028371729, 0.000017812084066678523, 0.000017857666665793616, 0.00001794904789529924, 0.00001799463049441434, 0.00001804021309352943, 0.00001808579569264453, 0.000018222759521265247, 0.000018268342120380347, 0.00001831392471949544, 0.000018359723349885962, 0.000018405305949001062, 0.000018588284439287728, 0.00001863408306967825, 0.00001867988170006878, 0.00001881749362251578, 0.000018909306914572253, 0.000019047134868294676, 0.000019093149529960627, 0.000019139164191626577, 0.000019276992145349, 0.00001932300680701495, 0.00001941482009907143, 0.000019460834760737374, 0.000019506633391127903, 0.000019552432021518425, 0.000019644245313574898, 0.00001969004394396542, 0.00001973584257435594, 0.000019873022434252092, 0.000019964403663757714, 0.000020009986262872808, 0.00002010136749237843, 0.000020146950091493523, 0.000020283913920114245, 0.000020329496519229338, 0.00002042087774873496, 0.000020512258978240582, 0.000020603640207746204, 0.000020649438838136726, 0.000020695237468527255, 0.000020741036098917777, 0.0000207868347293083, 0.00002083263335969882, 0.000020970245282145822, 0.000021108073235868252, 0.000021337714481647148, 0.00002147554243536957, 0.000021567355727426044, 0.000021659169019482516, 0.000021704967649873038, 0.000021750766280263567, 0.00002179656491065409, 0.00002184236354104461, 0.000021888162171435133, 0.000022025342031331283, 0.000022070924630446377, 0.000022116723260836905, 0.00002220810449034252, 0.00002225368708945762, 0.000022345068318963243, 0.000022482032147583965, 0.00002257341337708958, 0.000022664794606595202, 0.000022710593236985724, 0.000022756391867376246, 0.000022939586388938347, 0.000023021246211049767, - 0.00002302146224232519, - 0.000023021678273600617, - 0.000023021894304876046, 0.000023022110336151468, 0.000023022326367426896, 0.000023022542398702325, 0.000023022758429977754, 0.000023022974461253176, 0.000023023190492528604, 0.000023023406523804033, 0.000023023622555079455, 0.000023023838586354884, 0.000023024054617630312, 0.00002302427064890574, 0.00002306790896654199, 0.00002306812499781742, 0.000023068341029092847, 0.000023068557060368276, 0.000023068773091643698, 0.000023068989122919126, 0.000023069205154194555, 0.000023069421185469977, 0.000023113923628207947, 0.000023114139659483376, 0.000023114355690758804, 0.000023114571722034226, 0.000023159938289873898, 0.000023160154321149326, 0.000023160370352424748, 0.00002320573692026442, 0.00002320595295153985, 0.00002325175158193037, 0.0000232975502123209, 0.00002334334884271142, 0.000023389147473101943, 0.00002343494610349247, 0.000023480744733882994, 0.000023526543364273516, 0.000023572341994664038, 0.000023618140625054566, 0.000023663939255445088, 0.00002370973788583561, 0.000023755536516226132, 0.00002380133514661666, 0.000023847133777007183, 0.000023892932407397705, 0.000023938731037788227, 0.000023984529668178755, 0.000024030328298569277, 0.00002416772418974085, 0.000024305120080912423, 0.000024396717341693467, 0.00002444251597208399, 0.000024488314602474517, 0.00002453411323286504, 0.00002457991186325556, 0.00002462571049364609, 0.000024671509124036612, 0.000024717307754427134, 0.000024763106384817656, 0.000024808905015208184, 0.000024854703645598706, 0.00002490050227598923, 0.00002494630090637975, 0.00002499209953677028, 0.0000250378981671608, 0.000025083696797551323, 0.000025129495427941845, 0.000025175294058332374, 0.000025221092688722896, 0.000025266891319113418, 0.000025312689949503946, 0.000025358488579894468, 0.00002540428721028499, 0.000025450085840675512, 0.00002549588447106604, 0.000026316};
            windingExcitation["voltage"]["waveform"]["data"] = {836.9398584905659, 975.8942610062891, 1017.5805817610062, 1031.4760220125784, 1045.3714622641508, 1031.4760220125784, 1059.2669025157231, 938.6792452830186, 613.2075471698113, 975.8942610062891, 961.9988207547169, 739.6717767295597, 948.1033805031445, 920.3124999999998, 795.253537735849, 934.2079402515722, 823.0444182389936, 920.3124999999998, 836.9398584905659, 878.6261792452829, 892.5216194968552, 864.7307389937107, 850.8352987421383, 864.7307389937107, 878.6261792452829, 892.5216194968552, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 864.7307389937107, 878.6261792452829, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 878.6261792452829, 864.7307389937107, 864.7307389937107, 878.6261792452829, 878.6261792452829, 850.8352987421383, 809.1489779874214, 795.253537735849, 489.553852201258, 475.6584119496856, 461.76297169811323, 447.8675314465411, 475.6584119496856, 489.553852201258, 600.7173742138366, 711.880896226415, 753.5672169811321, 795.253537735849, 809.1489779874214, 823.0444182389936, 836.9398584905659, 836.9398584905659, 809.1489779874214, 753.5672169811321, 739.6717767295597, 711.880896226415, 586.8219339622642, 572.9264937106918, 545.1356132075473, 531.2401729559749, 517.3447327044025, 503.44929245283015, 489.553852201258, 489.553852201258, 503.44929245283015, 517.3447327044025, 531.2401729559749, 545.1356132075473, 628.5082547169811, 670.194575471698, 711.880896226415, 753.5672169811321, 767.4626572327043, 781.3580974842766, 795.253537735849, 809.1489779874214, 809.1489779874214, 809.1489779874214, 809.1489779874214, 795.253537735849, 781.3580974842766, 767.4626572327043, 753.5672169811321, 739.6717767295597, 725.7763364779873, 642.4036949685535, 572.9264937106918, 559.0310534591194, 545.1356132075473, 531.2401729559749, 517.3447327044025, 517.3447327044025, 517.3447327044025, 517.3447327044025, 545.1356132075473, 614.6128144654087, 628.5082547169811, 642.4036949685535, 684.0900157232704, 697.9854559748428, 711.880896226415, 725.7763364779873, 753.5672169811321, 767.4626572327043, 781.3580974842766, 781.3580974842766, 781.3580974842766, 781.3580974842766, 781.3580974842766, 767.4626572327043, 753.5672169811321, 725.7763364779873, 697.9854559748428, 684.0900157232704, 670.194575471698, 600.7173742138366, 586.8219339622642, 572.9264937106918, 559.0310534591194, 545.1356132075473, 545.1356132075473, 545.1356132075471, 572.9264937106916, 586.821933962264, 600.7173742138364, 614.6128144654085, 628.5082547169809, 656.2991352201257, 670.1945754716978, 684.0900157232702, 697.9854559748426, 725.7763364779871, 739.6717767295595, 753.5672169811319, 767.462657232704, 767.462657232704, 767.462657232704, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 642.4036949685533, 628.5082547169809, 614.6128144654085, 600.7173742138364, 586.821933962264, 572.9264937106916, 559.0310534591192, 559.0310534591192, 559.0310534591192, 559.0310534591192, 572.9264937106916, 586.821933962264, 614.6128144654085, 642.4036949685533, 656.2991352201257, 670.1945754716978, 684.0900157232702, 697.9854559748426, 711.8808962264147, 725.7763364779871, 739.6717767295595, 753.5672169811319, 753.5672169811319, 739.6717767295595, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 628.5082547169809, 614.6128144654085, 600.7173742138364, 600.7173742138364, 586.821933962264, 572.9264937106916, 572.9264937106916, 572.9264937106916, 586.821933962264, 600.7173742138364, 628.5082547169809, 642.4036949685533, 656.2991352201257, 684.0900157232702, 697.9854559748426, 711.8808962264147, 725.7763364779871, 725.7763364779871, 725.7763364779871, 739.6717767295595, 739.6717767295595, 739.6717767295595, 725.7763364779871, 711.8808962264147, 697.9854559748426, 684.0900157232702, 670.1945754716978, 642.4036949685533, 628.5082547169809, 614.6128144654085, 600.7173742138364, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 586.821933962264, 600.7173742138364, 628.5082547169809, 670.1945754716978, 697.9854559748426, 711.8808962264147, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 725.7763364779871, 711.8808962264147, 697.9854559748426, 697.9854559748426, 684.0900157232702, 670.1945754716978, 656.2991352201257, 628.5082547169809, 614.6128144654085, 600.7173742138364, 600.7173742138364, 600.7173742138364, 600.7173742138364, 38.47287735849068, 24.577437106918296, 10.681996855345915, 3.2134433962264666, 17.108883647798848, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 86.5860849056603, 100.48152515723268, 114.37696540880506, 128.27240566037744, 142.16784591194983, 156.0632861635222, 17.108883647798848, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 86.5860849056603, 100.48152515723268, 114.37696540880506, 31.00432389937123, 44.89976415094361, 58.79520440251554, 72.69064465408792, 44.89976415094361, 58.79520440251554, 72.69064465408792, 44.89976415094361, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554, 58.79520440251554};

            windingExcitation["current"]["waveform"]["data"] = {-0.9, 0.9, -0.9};
            windingExcitation["current"]["waveform"]["time"] = {0, 0.000026316 / 2, 0.000026316};
            windingExcitation["current"]["waveform"]["ancillaryLabel"] = "Triangular";

            operatingPointJson["excitationsPerWinding"].push_back(windingExcitation);
        }
        inputsJson["operatingPoints"].push_back(operatingPointJson);

        inputsJson["designRequirements"] = json();
        inputsJson["designRequirements"]["magnetizingInductance"]["nominal"] = 1000e-6;
        inputsJson["designRequirements"]["turnsRatios"] = json::array();
        inputsJson["designRequirements"]["turnsRatios"].push_back(10);

        OpenMagnetics::InputsWrapper inputs(inputsJson);

        inputs.process_waveforms();

        {
            auto ea = inputs.get_operating_point(0).get_excitations_per_winding()[0];
            std::cout << "ea.get_current()->get_processed()->get_peak().value(): " << ea.get_current()->get_processed()->get_peak().value() << std::endl;
            std::cout << "ea.get_current()->get_processed()->get_rms().value(): " << ea.get_current()->get_processed()->get_rms().value() << std::endl;
        }

        {
            auto ea = inputs.get_operating_point(0).get_excitations_per_winding()[1];
            std::cout << "ea.get_current()->get_processed()->get_peak().value(): " << ea.get_current()->get_processed()->get_peak().value() << std::endl;
            std::cout << "ea.get_current()->get_processed()->get_rms().value(): " << ea.get_current()->get_processed()->get_rms().value() << std::endl;
        }


        {
            auto ea = inputs.get_operating_point(0).get_excitations_per_winding()[2];
            std::cout << "ea.get_current()->get_processed()->get_peak().value(): " << ea.get_current()->get_processed()->get_peak().value() << std::endl;
            std::cout << "ea.get_current()->get_processed()->get_rms().value(): " << ea.get_current()->get_processed()->get_rms().value() << std::endl;
        }


        // auto windingLosses = OpenMagnetics::WindingLosses().calculate_losses(magnetic, inputs.get_operating_point(0), temperature);
        // json windingLossesJson;
        // to_json(windingLossesJson, windingLosses);
        // std::cout << windingLossesJson << std::endl;

        auto simulator = OpenMagnetics::MagneticSimulator();
        auto operatingPoint = inputs.get_operating_point(0);
        // auto coreLosses = simulator.calculate_core_losses(operatingPoint, magnetic);
        auto mas = simulator.simulate(inputs, magnetic);
        // json coreLossesJson;
        // to_json(coreLossesJson, coreLosses);
        // std::cout << coreLossesJson << std::endl;

        OpenMagnetics::MagneticAdviser::preview_magnetic(mas);

        {
            auto outFile = outputFilePath;
            outFile.append("Test_Flyback_Simulation.mas.json");
            OpenMagnetics::to_file(outFile, mas);
        }


        {
            auto outFile = outputFilePath;
            outFile.append("Test_Flyback_Simulation_Waveform_Primary_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_Flyback_Simulation_Waveform_Primary_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 0).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_Flyback_Simulation_Waveform_Secondaty_Current.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_current()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_Flyback_Simulation_Waveform_Secondaty_Voltage.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, false, true);
            painter.paint_waveform(inputs.get_winding_excitation(0, 1).get_voltage()->get_waveform().value());
            painter.export_svg();
            settings->reset();
        }

        {
            auto outFile = outputFilePath;
            outFile.append("Test_Flyback_Simulation.svg");
            std::filesystem::remove(outFile); 
            OpenMagnetics::Painter painter(outFile, true);

            settings->set_painter_mode(OpenMagnetics::Painter::PainterModes::CONTOUR);
            settings->set_painter_number_points_x(100);
            settings->set_painter_number_points_y(100);
            settings->set_painter_maximum_value_colorbar(8000);
            settings->set_painter_minimum_value_colorbar(500);
            settings->set_painter_logarithmic_scale(false);
            settings->set_painter_include_fringing(false);

            painter.paint_magnetic_field(inputs.get_operating_point(0), magnetic);
            painter.paint_core(magnetic);
            painter.paint_bobbin(magnetic);
            painter.paint_coil_turns(magnetic);
            painter.export_svg();
            settings->reset();
        }
    }

    TEST(Test_Simulator_Web_0) {

        OpenMagnetics::MagneticWrapper magnetic(json::parse(R"({"coil":{"bobbin":{"distributorsInfo":null,"functionalDescription":null,"manufacturerInfo":null,"name":null,"processedDescription":{"columnDepth":0.004347500000000001,"columnShape":"round","columnThickness":0.0007975000000000005,"columnWidth":0.004347500000000001,"coordinates":[0,0,0],"pins":null,"wallThickness":0.0008723921229391407,"windingWindows":[{"angle":null,"area":0.000022027638255648275,"coordinates":[0.0059425,0,0],"height":0.006905215754121718,"radialHeight":null,"sectionsAlignment":"inner or top","sectionsOrientation":"overlapping","shape":"rectangular","width":0.0031899999999999993}]}},"functionalDescription":[{"connections":null,"isolationSide":"primary","name":"Primary","numberParallels":3,"numberTurns":27,"wire":{"coating":{"breakdownVoltage":2200,"grade":1,"material":null,"numberLayers":null,"temperatureRating":null,"thickness":null,"thicknessLayers":null,"type":"enamelled"},"conductingArea":{"excludeMaximum":null,"excludeMinimum":null,"maximum":null,"minimum":null,"nominal":7.068583470577036e-8},"conductingDiameter":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.000303999999999,"minimum":0.000296,"nominal":0.00030000000000000003},"conductingHeight":null,"conductingWidth":null,"edgeRadius":null,"manufacturerInfo":{"cost":null,"datasheetUrl":null,"family":null,"name":"Elektrisola","orderCode":null,"reference":null,"status":null},"material":"copper","name":"Round 0.3 - Grade 1","numberConductors":1,"outerDiameter":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00033400000000000004,"minimum":0.000319,"nominal":null},"outerHeight":null,"outerWidth":null,"standard":"IEC 60317","standardName":"0.3 mm","strand":null,"type":"round"}},{"connections":null,"isolationSide":"secondary","name":"Secondary","numberParallels":2,"numberTurns":25,"wire":{"coating":{"breakdownVoltage":1290,"grade":1,"material":null,"numberLayers":null,"temperatureRating":null,"thickness":null,"thicknessLayers":null,"type":"enamelled"},"conductingArea":{"excludeMaximum":null,"excludeMinimum":null,"maximum":null,"minimum":null,"nominal":1.2818954663707792e-7},"conductingDiameter":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.000406,"minimum":0.000399,"nominal":0.000404},"conductingHeight":null,"conductingWidth":null,"edgeRadius":null,"manufacturerInfo":{"cost":null,"datasheetUrl":null,"family":null,"name":"Elektrisola","orderCode":null,"reference":null,"status":null},"material":"copper","name":"Round 26.0 - Single Build","numberConductors":1,"outerDiameter":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.000439,"minimum":0.00042199999999900005,"nominal":0.00043099999999900005},"outerHeight":null,"outerWidth":null,"standard":"NEMA MW 1000 C","standardName":"26 AWG","strand":null,"type":"round"}}],"layersDescription":[{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,2.168404344971009e-19],"dimensions":[0.0003265,0.006902900000000002],"fillingFactor":0.9929450786396298,"insulationMaterial":null,"name":"Primary section 0 layer 0","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0.7777777777777778,0,0],"winding":"Primary"}],"section":"Primary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-4.999999986526199e-10],"dimensions":[0.0003265,0.006886458999999999],"fillingFactor":0.9456619796567903,"insulationMaterial":null,"name":"Primary section 0 layer 1","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0.2222222222222222,0.5185185185185185,0],"winding":"Primary"}],"section":"Primary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-4.999999986526199e-10],"dimensions":[0.0003265,0.006886458999999999],"fillingFactor":0.9456619796567903,"insulationMaterial":null,"name":"Primary section 0 layer 2","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0,0.48148148148148145,0.25925925925925924],"winding":"Primary"}],"section":"Primary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-4.999999986526199e-10],"dimensions":[0.0003265,0.006886458999999999],"fillingFactor":0.9456619796567903,"insulationMaterial":null,"name":"Primary section 0 layer 3","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0,0,0.7407407407407407],"winding":"Primary"}],"section":"Primary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.005666,0],"dimensions":[0.000025,0.006905215754121718],"fillingFactor":1,"insulationMaterial":null,"name":"Insulation between Primary and Primary section 1 layer 0","orientation":"overlapping","partialWindings":[],"section":"Insulation between Primary and Primary section 1","turnsAlignment":"spread","type":"insulation","windingStyle":null},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-2.168404344971009e-19],"dimensions":[0.00043099999999900005,0.006805039999999001],"fillingFactor":0.8114156312411489,"insulationMaterial":null,"name":"Secondary section 0 layer 0","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0.52,0],"winding":"Secondary"}],"section":"Secondary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-2.168404344971009e-19],"dimensions":[0.00043099999999900005,0.006805039999999001],"fillingFactor":0.8114156312411489,"insulationMaterial":null,"name":"Secondary section 0 layer 1","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0.48,0.04],"winding":"Secondary"}],"section":"Secondary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-5.499999999707128e-9],"dimensions":[0.00043099999999900005,0.006760784999999],"fillingFactor":0.748999044222599,"insulationMaterial":null,"name":"Secondary section 0 layer 2","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0,0.48],"winding":"Secondary"}],"section":"Secondary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-5.499999999707128e-9],"dimensions":[0.00043099999999900005,0.006760784999999],"fillingFactor":0.748999044222599,"insulationMaterial":null,"name":"Secondary section 0 layer 3","orientation":"overlapping","partialWindings":[{"connections":null,"parallelsProportion":[0,0.48],"winding":"Secondary"}],"section":"Secondary section 0","turnsAlignment":"spread","type":"conduction","windingStyle":"windByConsecutiveTurns"},{"additionalCoordinates":null,"coordinateSystem":"cartesian","coordinates":[0.007414999999999002,0],"dimensions":[0.000025,0.006905215754121718],"fillingFactor":1,"insulationMaterial":null,"name":"Insulation between Secondary and Secondary section 3 layer 0","orientation":"overlapping","partialWindings":[],"section":"Insulation between Secondary and Secondary section 3","turnsAlignment":"spread","type":"insulation","windingStyle":null}],"sectionsDescription":[{"coordinateSystem":"cartesian","coordinates":[0.005000500000000001,0],"dimensions":[0.0013060000000000003,0.006902900000000002],"fillingFactor":0.9200062369406012,"layersAlignment":null,"layersOrientation":"overlapping","margin":[0,0],"name":"Primary section 0","partialWindings":[{"connections":null,"parallelsProportion":[1,1,1],"winding":"Primary"}],"type":"conduction","windingStyle":"windByConsecutiveTurns"},{"coordinateSystem":"cartesian","coordinates":[0.005666000000000001,0],"dimensions":[0.000025,0.006905215754121718],"fillingFactor":1,"layersAlignment":null,"layersOrientation":"overlapping","margin":null,"name":"Insulation between Primary and Primary section 1","partialWindings":[],"type":"insulation","windingStyle":null},{"coordinateSystem":"cartesian","coordinates":[0.006540499999999502,0],"dimensions":[0.001723999999999,0.006805039999999001],"fillingFactor":0.7448651291652622,"layersAlignment":null,"layersOrientation":"overlapping","margin":[0,0],"name":"Secondary section 0","partialWindings":[{"connections":null,"parallelsProportion":[1,1],"winding":"Secondary"}],"type":"conduction","windingStyle":"windByConsecutiveTurns"},{"coordinateSystem":"cartesian","coordinates":[0.007414999999999002,0],"dimensions":[0.000025,0.006905215754121718],"fillingFactor":1,"layersAlignment":null,"layersOrientation":"overlapping","margin":null,"name":"Insulation between Secondary and Secondary section 3","partialWindings":[],"type":"insulation","windingStyle":null}],"turnsDescription":[{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0032882000000000007],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 0","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0029593800000000006],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 1","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0026305600000000005],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 2","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0023017400000000005],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 3","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0019729200000000004],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 4","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0016441000000000003],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 5","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0013152800000000003],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 6","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0009864600000000002],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 7","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0006576400000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 8","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,0.0003288200000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 9","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,1.0842021724855044e-19],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 10","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00032881999999999985],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 11","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.0006576399999999999],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 12","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00098646],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 13","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00131528],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 14","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.0016441000000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 15","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00197292],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 16","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00230174],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 17","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00263056],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 18","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.00295938],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 19","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004510750000000001,-0.0032882000000000002],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 0","length":0.028341878124360325,"name":"Primary parallel 0 turn 20","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.003279979000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 0 turn 21","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.002934718000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 0 turn 22","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.002589457000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 0 turn 23","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.0022441960000000013],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 0 turn 24","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.0018989350000000013],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 0 turn 25","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.0015536740000000014],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 0 turn 26","orientation":"clockwise","parallel":0,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.0012084130000000015],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 0","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.0008631520000000015],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 1","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.0005178910000000014],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 2","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,0.00017263000000000142],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 3","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0001726309999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 4","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0005178919999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 5","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0008631529999999987],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 6","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0012084139999999988],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 7","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0015536749999999987],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 8","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0018989359999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 9","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0022441969999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 10","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0025894579999999985],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 11","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0029347189999999984],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 12","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.004837250000000001,-0.0032799799999999983],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 1","length":0.030393338127154463,"name":"Primary parallel 1 turn 13","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.003279979000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 14","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.002934718000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 15","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.002589457000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 16","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.0022441960000000013],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 17","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.0018989350000000013],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 18","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.0015536740000000014],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 19","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.0012084130000000015],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 20","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.0008631520000000015],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 21","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.0005178910000000014],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 22","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,0.00017263000000000142],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 23","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0001726309999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 24","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0005178919999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 25","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0008631529999999987],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 1 turn 26","orientation":"clockwise","parallel":1,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0012084139999999988],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 0","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0015536749999999987],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 1","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0018989359999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 2","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0022441969999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 3","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0025894579999999985],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 4","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0029347189999999984],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 5","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005163750000000001,-0.0032799799999999983],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 2","length":0.03244479812994859,"name":"Primary parallel 2 turn 6","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.003279979000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 7","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.002934718000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 8","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.002589457000000001],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 9","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.0022441960000000013],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 10","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.0018989350000000013],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 11","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.0015536740000000014],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 12","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.0012084130000000015],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 13","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.0008631520000000015],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 14","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.0005178910000000014],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 15","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,0.00017263000000000142],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 16","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0001726309999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 17","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0005178919999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 18","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0008631529999999987],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 19","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0012084139999999988],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 20","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0015536749999999987],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 21","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0018989359999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 22","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0022441969999999986],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 23","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0025894579999999985],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 24","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0029347189999999984],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 25","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005490250000000001,-0.0032799799999999983],"dimensions":[0.0003265,0.0003265],"layer":"Primary section 0 layer 3","length":0.03449625813274273,"name":"Primary parallel 2 turn 26","orientation":"clockwise","parallel":2,"rotation":0,"section":"Primary section 0","winding":"Primary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,0.00318702],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 0","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,0.00265585],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 1","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,0.00212468],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 2","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,0.0015935099999999998],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 3","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,0.0010623399999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 4","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,0.0005311699999999999],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 5","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-1.0842021724855044e-19],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 6","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-0.0005311700000000001],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 7","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-0.0010623400000000002],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 8","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-0.0015935100000000002],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 9","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-0.0021246800000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 10","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-0.0026558500000000004],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 11","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.005893999999999502,-0.0031870200000000005],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 0","length":0.03703309420051335,"name":"Secondary parallel 0 turn 12","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,0.00318702],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 13","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,0.00265585],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 14","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,0.00212468],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 15","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,0.0015935099999999998],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 16","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,0.0010623399999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 17","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,0.0005311699999999999],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 18","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-1.0842021724855044e-19],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 19","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-0.0005311700000000001],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 20","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-0.0010623400000000002],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 21","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-0.0015935100000000002],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 22","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-0.0021246800000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 23","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-0.0026558500000000004],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 0 turn 24","orientation":"clockwise","parallel":0,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006324999999999502,-0.0031870200000000005],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 1","length":0.03974114706790775,"name":"Secondary parallel 1 turn 0","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,0.0031648870000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 1","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,0.0025894520000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 2","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,0.0020140170000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 3","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,0.0014385820000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 4","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,0.0008631470000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 5","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,0.0002877120000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 6","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-0.0002877229999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 7","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-0.0008631579999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 8","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-0.0014385929999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 9","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-0.0020140279999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 10","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-0.0025894629999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 11","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.006755999999999502,-0.0031648979999999998],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 2","length":0.042449199935302155,"name":"Secondary parallel 1 turn 12","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,0.0031648870000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 13","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,0.0025894520000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 14","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,0.0020140170000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 15","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,0.0014385820000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 16","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,0.0008631470000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 17","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,0.0002877120000000003],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 18","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-0.0002877229999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 19","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-0.0008631579999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 20","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-0.0014385929999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 21","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-0.0020140279999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 22","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-0.0025894629999999997],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 23","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"},{"additionalCoordinates":null,"angle":null,"coordinateSystem":"cartesian","coordinates":[0.007186999999999502,-0.0031648979999999998],"dimensions":[0.00043099999999900005,0.00043099999999900005],"layer":"Secondary section 0 layer 3","length":0.04515725280269656,"name":"Secondary parallel 1 turn 24","orientation":"clockwise","parallel":1,"rotation":0,"section":"Secondary section 0","winding":"Secondary"}]},"core":{"distributorsInfo":[],"functionalDescription":{"coating":null,"gapping":[{"length":0.000341,"type":"subtractive"},{"length":0.000005,"type":"residual"},{"length":0.000005,"type":"residual"}],"material":"3C95","numberStacks":1,"shape":{"aliases":[],"dimensions":{"A":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0203,"minimum":0.0195,"nominal":null},"B":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00675,"minimum":0.00665,"nominal":null},"C":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00725,"minimum":0.00695,"nominal":null},"D":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00445,"minimum":0.0042,"nominal":null},"E":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0154,"minimum":0.01475,"nominal":null},"F":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00725,"minimum":0.00695,"nominal":null},"G":{"excludeMaximum":null,"excludeMinimum":null,"maximum":null,"minimum":0.0093,"nominal":null},"J":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0172,"minimum":0.0165,"nominal":null},"R":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0003,"minimum":null,"nominal":null}},"family":"rm","familySubtype":"2","magneticCircuit":"open","name":"RM 7/I","type":"standard"},"type":"two-piece set"},"geometricalDescription":[{"coordinates":[0,0,0],"dimensions":null,"insulationMaterial":null,"machining":[{"coordinates":[0,0.00017,0],"length":0.00034}],"material":"3C95","rotation":[3.141592653589793,3.141592653589793,0],"shape":{"aliases":[],"dimensions":{"A":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0203,"minimum":0.0195,"nominal":null},"B":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00675,"minimum":0.00665,"nominal":null},"C":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00725,"minimum":0.00695,"nominal":null},"D":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00445,"minimum":0.0042,"nominal":null},"E":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0154,"minimum":0.01475,"nominal":null},"F":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00725,"minimum":0.00695,"nominal":null},"G":{"excludeMaximum":null,"excludeMinimum":null,"maximum":null,"minimum":0.0093,"nominal":null},"J":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0172,"minimum":0.0165,"nominal":null},"R":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0003,"minimum":null,"nominal":null}},"family":"rm","familySubtype":"2","magneticCircuit":"open","name":"RM 7/I","type":"standard"},"type":"half set"},{"coordinates":[0,0,0],"dimensions":null,"insulationMaterial":null,"machining":null,"material":"3C95","rotation":[0,0,0],"shape":{"aliases":[],"dimensions":{"A":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0203,"minimum":0.0195,"nominal":null},"B":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00675,"minimum":0.00665,"nominal":null},"C":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00725,"minimum":0.00695,"nominal":null},"D":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00445,"minimum":0.0042,"nominal":null},"E":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0154,"minimum":0.01475,"nominal":null},"F":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.00725,"minimum":0.00695,"nominal":null},"G":{"excludeMaximum":null,"excludeMinimum":null,"maximum":null,"minimum":0.0093,"nominal":null},"J":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0172,"minimum":0.0165,"nominal":null},"R":{"excludeMaximum":null,"excludeMinimum":null,"maximum":0.0003,"minimum":null,"nominal":null}},"family":"rm","familySubtype":"2","magneticCircuit":"open","name":"RM 7/I","type":"standard"},"type":"half set"}],"manufacturerInfo":{"cost":null,"datasheetUrl":"https://ferroxcube.com/upload/media/product/file/Pr_ds/RM7_I.pdf","family":null,"name":"Ferroxcube","orderCode":null,"reference":"RM7/I-3C95-A160","status":"production"},"name":"RM 7/I - 3C95 - Gapped 0.340 mm","processedDescription":{"columns":[{"area":0.00004,"coordinates":[0,0,0],"depth":0.0071,"height":0.00865,"minimumDepth":null,"minimumWidth":null,"shape":"round","type":"central","width":0.0071},{"area":0.000025,"coordinates":[0.008744,0,0],"depth":0.010361,"height":0.00865,"minimumDepth":null,"minimumWidth":null,"shape":"irregular","type":"lateral","width":0.002413},{"area":0.000025,"coordinates":[-0.008744,0,0],"depth":0.010361,"height":0.00865,"minimumDepth":null,"minimumWidth":null,"shape":"irregular","type":"lateral","width":0.002413}],"depth":0.015075,"effectiveParameters":{"effectiveArea":0.00004338158927496835,"effectiveLength":0.03178623228085245,"effectiveVolume":0.0000013789372734066815,"minimumArea":0.000039591921416865375},"height":0.013399999999999999,"width":0.0199,"windingWindows":[{"angle":null,"area":0.000034491875,"coordinates":[0.00355,0],"height":0.00865,"radialHeight":null,"sectionsAlignment":null,"sectionsOrientation":null,"shape":null,"width":0.0039875}]}}})"));
        OpenMagnetics::InputsWrapper inputs(json::parse(R"({"designRequirements":{"magnetizingInductance":{"nominal":0.0001},"name":"My Design Requirements","turnsRatios":[{"nominal":1}]},"operatingPoints":[{"name":"Operating Point No. 1","conditions":{"ambientTemperature":42},"excitationsPerWinding":[{"name":"Primary winding excitation","frequency":100000,"current":{"waveform":{"data":[-5,5,-5],"time":[0,0.000005,0.00001]},"processed":{"dutyCycle":0.5,"peakToPeak":10,"offset":0,"label":"Triangular","acEffectiveFrequency":110746.40291779551,"effectiveFrequency":110746.40291779551,"peak":5,"rms":2.8874560332150576,"thd":0.12151487440704967},"harmonics":{"amplitudes":[1.1608769501236793e-14,4.05366124583194,1.787369544444173e-15,0.4511310569983995,9.749053004706756e-16,0.16293015292554872,4.036157626725542e-16,0.08352979924600704,3.4998295008010614e-16,0.0508569581336163,3.1489164048780735e-16,0.034320410449418075,3.142469873118059e-16,0.024811988673843106,2.3653352035940994e-16,0.018849001010678823,2.9306524147249266e-16,0.014866633059596499,1.796485796132569e-16,0.012077180559557785,1.6247782523152451e-16,0.010049063750920609,1.5324769149805092e-16,0.008529750975091871,1.0558579733068502e-16,0.007363501410705499,7.513269775674661e-17,0.006450045785294609,5.871414177162291e-17,0.005722473794997712,9.294731722001391e-17,0.005134763398167541,1.194820309200107e-16,0.004654430423785411,8.2422739080512e-17,0.004258029771397032,9.5067306351894e-17,0.0039283108282380024,1.7540347128474968e-16,0.0036523670873925395,9.623794010508822e-17,0.0034204021424253787,1.4083470894369491e-16,0.0032248884817922927,1.4749333016985644e-16,0.0030599828465501895,1.0448590642474364e-16,0.002921112944200383,7.575487373767413e-18,0.002804680975178716,7.419510610361002e-17,0.0027078483284668376,3.924741709073613e-17,0.0026283777262804953,2.2684279102637236e-17,0.0025645167846443107,8.997077625295079e-17,0.0025149120164513483,7.131074184849219e-17,0.0024785457043284276,9.354417496250849e-17,0.0024546904085875065,1.2488589642405877e-16,0.0024428775264784264],"frequencies":[0,100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,1100000,1200000,1300000,1400000,1500000,1600000,1700000,1800000,1900000,2000000,2100000,2200000,2300000,2400000,2500000,2600000,2700000,2800000,2900000,3000000,3100000,3200000,3300000,3400000,3500000,3600000,3700000,3800000,3900000,4000000,4100000,4200000,4300000,4400000,4500000,4600000,4700000,4800000,4900000,5000000,5100000,5200000,5300000,5400000,5500000,5600000,5700000,5800000,5900000,6000000,6100000,6200000,6300000]}},"voltage":{"waveform":{"data":[-20.5,70.5,70.5,-20.5,-20.5],"time":[0,0,0.000005,0.000005,0.00001]},"processed":{"dutyCycle":0.5,"peakToPeak":100,"offset":0,"label":"Rectangular","acEffectiveFrequency":591485.5360118389,"effectiveFrequency":553357.3374711702,"peak":70.5,"rms":51.572309672924284,"thd":0.4833151484524849},"harmonics":{"amplitudes":[24.2890625,57.92076613061847,1.421875,19.27588907896988,1.421875,11.528257939603122,1.421875,8.194467538528329,1.421875,6.331896912839248,1.421875,5.137996046859012,1.421875,4.304077056139349,1.421875,3.6860723299088454,1.421875,3.207698601961777,1.421875,2.8247804703632298,1.421875,2.509960393415185,1.421875,2.2453859950684323,1.421875,2.01890737840567,1.421875,1.8219644341144872,1.421875,1.6483482744897402,1.421875,1.4934420157473332,1.421875,1.3537375367153817,1.421875,1.2265178099275544,1.421875,1.1096421410704556,1.421875,1.0013973584174929,1.421875,0.9003924136274832,1.421875,0.8054822382572133,1.421875,0.7157117294021269,1.421875,0.6302738400635857,1.421875,0.5484777114167545,1.421875,0.46972405216147894,1.421875,0.3934858059809043,1.421875,0.31929270856030145,1.421875,0.24671871675852053,1.421875,0.17537155450693565,1.421875,0.10488380107099537,1.421875,0.034905072061178544],"frequencies":[0,100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,1100000,1200000,1300000,1400000,1500000,1600000,1700000,1800000,1900000,2000000,2100000,2200000,2300000,2400000,2500000,2600000,2700000,2800000,2900000,3000000,3100000,3200000,3300000,3400000,3500000,3600000,3700000,3800000,3900000,4000000,4100000,4200000,4300000,4400000,4500000,4600000,4700000,4800000,4900000,5000000,5100000,5200000,5300000,5400000,5500000,5600000,5700000,5800000,5900000,6000000,6100000,6200000,6300000]}}},{"name":"Primary winding excitation","frequency":100000,"current":{"waveform":{"ancillaryLabel":null,"data":[-5,5,-5],"numberPeriods":null,"time":[0,0.000005,0.00001]},"processed":{"dutyCycle":0.5,"peakToPeak":10,"offset":0,"label":"Triangular","acEffectiveFrequency":110746.40291779551,"effectiveFrequency":110746.40291779551,"peak":5,"rms":2.8874560332150576,"thd":0.12151487440704967},"harmonics":{"amplitudes":[1.1608769501236793e-14,4.05366124583194,1.787369544444173e-15,0.4511310569983995,9.749053004706756e-16,0.16293015292554872,4.036157626725542e-16,0.08352979924600704,3.4998295008010614e-16,0.0508569581336163,3.1489164048780735e-16,0.034320410449418075,3.142469873118059e-16,0.024811988673843106,2.3653352035940994e-16,0.018849001010678823,2.9306524147249266e-16,0.014866633059596499,1.796485796132569e-16,0.012077180559557785,1.6247782523152451e-16,0.010049063750920609,1.5324769149805092e-16,0.008529750975091871,1.0558579733068502e-16,0.007363501410705499,7.513269775674661e-17,0.006450045785294609,5.871414177162291e-17,0.005722473794997712,9.294731722001391e-17,0.005134763398167541,1.194820309200107e-16,0.004654430423785411,8.2422739080512e-17,0.004258029771397032,9.5067306351894e-17,0.0039283108282380024,1.7540347128474968e-16,0.0036523670873925395,9.623794010508822e-17,0.0034204021424253787,1.4083470894369491e-16,0.0032248884817922927,1.4749333016985644e-16,0.0030599828465501895,1.0448590642474364e-16,0.002921112944200383,7.575487373767413e-18,0.002804680975178716,7.419510610361002e-17,0.0027078483284668376,3.924741709073613e-17,0.0026283777262804953,2.2684279102637236e-17,0.0025645167846443107,8.997077625295079e-17,0.0025149120164513483,7.131074184849219e-17,0.0024785457043284276,9.354417496250849e-17,0.0024546904085875065,1.2488589642405877e-16,0.0024428775264784264],"frequencies":[0,100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,1100000,1200000,1300000,1400000,1500000,1600000,1700000,1800000,1900000,2000000,2100000,2200000,2300000,2400000,2500000,2600000,2700000,2800000,2900000,3000000,3100000,3200000,3300000,3400000,3500000,3600000,3700000,3800000,3900000,4000000,4100000,4200000,4300000,4400000,4500000,4600000,4700000,4800000,4900000,5000000,5100000,5200000,5300000,5400000,5500000,5600000,5700000,5800000,5900000,6000000,6100000,6200000,6300000]}},"voltage":{"waveform":{"ancillaryLabel":null,"data":[-50,50,50,-50,-50],"numberPeriods":null,"time":[0,0,0.000005,0.000005,0.00001]},"processed":{"dutyCycle":0.5,"peakToPeak":100,"offset":0,"label":"Rectangular","acEffectiveFrequency":591485.536011839,"effectiveFrequency":591449.4202715514,"peak":50,"rms":50,"thd":0.48331514845248497},"harmonics":{"amplitudes":[0.78125,63.64919355013018,1.5625,21.18229569117569,1.5625,12.668415318245188,1.5625,9.004909382998164,1.5625,6.958128475647527,1.5625,5.646149502042871,1.5625,4.729755006746538,1.5625,4.050628933965765,1.5625,3.524943518639316,1.5625,3.104154363036517,1.5625,2.7581982345221827,1.5625,2.467457137437843,1.5625,2.2185795367095267,1.5625,2.0021587188071255,1.5625,1.8113717302085082,1.5625,1.6411450722498175,1.5625,1.487623666720196,1.5625,1.3478217691511587,1.5625,1.2193869682092893,1.5625,1.100436657601639,1.5625,0.9894422127774558,1.5625,0.8851453167661671,1.5625,0.7864964059364037,1.5625,0.6926086154544899,1.5625,0.60272275979863,1.5625,0.5161802771005264,1.5625,0.43240198459440116,1.5625,0.3508711083080249,1.5625,0.27111946896540395,1.5625,0.192715993963664,1.5625,0.11525692425384548,1.5625,0.03835722204524927],"frequencies":[0,100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,1100000,1200000,1300000,1400000,1500000,1600000,1700000,1800000,1900000,2000000,2100000,2200000,2300000,2400000,2500000,2600000,2700000,2800000,2900000,3000000,3100000,3200000,3300000,3400000,3500000,3600000,3700000,3800000,3900000,4000000,4100000,4200000,4300000,4400000,4500000,4600000,4700000,4800000,4900000,5000000,5100000,5200000,5300000,5400000,5500000,5600000,5700000,5800000,5900000,6000000,6100000,6200000,6300000]}}}]}]})"));

        auto simulator = OpenMagnetics::MagneticSimulator();
        auto mas = simulator.simulate(inputs, magnetic);

        OpenMagnetics::MagneticAdviser::preview_magnetic(mas);
    }
}